<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Future-Ready Skills Learning App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#ff7b54" />

  <style>
    :root {
      --bg: #f7f4ff;
      --primary: #ff7b54;
      --primary-dark: #ff5a2b;
      --accent: #4cc9f0;
      --text: #1f2330;
      --card: #ffffff;
      --shadow-soft: 0 10px 25px rgba(15, 23, 42, 0.1);
      --radius-lg: 18px;
      --radius-xl: 24px;
      --ai-bg: #fff9f2;
      --ai-border: #ffe0b2;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        Roboto, sans-serif;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at top, #ffe7da, #f7f4ff);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
      color: var(--text);
    }

    .app-shell {
      width: 100%;
      max-width: 1100px;
      background: linear-gradient(145deg, #ffffff, #fef2ff);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-soft);
      padding: 16px;
      position: relative;
      overflow: hidden;
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.8fr);
      gap: 12px;
    }

    @media (max-width: 768px) {
      .app-shell {
        grid-template-columns: 1fr;
        max-height: 100vh;
        overflow-y: auto;
      }
    }

    .app-shell::before {
      content: "";
      position: absolute;
      width: 220px;
      height: 220px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255,255,255,0.9), transparent);
      top: -60px;
      right: -40px;
      opacity: 0.7;
      pointer-events: none;
    }

    header {
      grid-column: 1 / -1;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 4px;
      position: relative;
      z-index: 1;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-circle {
      width: 52px;
      height: 52px;
      border-radius: 50%;
      background: conic-gradient(from 200deg, #ff7b54, #ffb347, #ffe66d, #ff7b54);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 22px;
      font-weight: 800;
      box-shadow: 0 5px 12px rgba(255,123,84,0.5);
    }

    .brand-text h1 {
      font-size: 20px;
      font-weight: 800;
    }

    .brand-text p {
      font-size: 12px;
      opacity: 0.75;
    }

    .top-actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .chip {
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 11px;
      background: rgba(76, 201, 240, 0.12);
      color: #0077b6;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .chip span {
      font-size: 15px;
    }

    .lang-select {
      border-radius: 999px;
      border: none;
      padding: 6px 10px;
      font-size: 11px;
      background: rgba(255,255,255,0.85);
      box-shadow: 0 3px 8px rgba(15,23,42,0.12);
    }

    .panel {
      background: rgba(255,255,255,0.96);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      padding: 12px 12px 14px;
      position: relative;
      z-index: 1;
      max-height: 500px;
      overflow-y: auto;
    }

    .panel-left {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .panel-right {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .panel h2 {
      font-size: 16px;
      margin-bottom: 4px;
    }

    .subtitle {
      font-size: 12px;
      opacity: 0.75;
      margin-bottom: 8px;
    }

    .grid-classes {
      display: grid;
      grid-template-columns: repeat(6, minmax(0, 1fr));
      gap: 6px;
      margin-bottom: 8px;
    }

    @media (max-width: 768px) {
      .grid-classes {
        grid-template-columns: repeat(4, minmax(0, 1fr));
      }
    }

    .pill-btn {
      border: none;
      border-radius: 999px;
      padding: 6px 0;
      font-size: 12px;
      font-weight: 600;
      background: #fff6f0;
      color: #ff7b54;
      box-shadow: 0 2px 6px rgba(15,23,42,0.08);
      cursor: pointer;
      transition: transform 0.12s ease, box-shadow 0.12s ease,
        background 0.12s ease, color 0.12s ease;
      text-align: center;
      white-space: nowrap;
    }

    .pill-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(15,23,42,0.14);
      background: #ffe7d6;
    }

    .pill-btn.active {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: #fff;
    }

    .subjects-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .subject-card {
      flex: 1 1 calc(50% - 10px);
      min-width: 130px;
      background: #f7f7ff;
      border-radius: 14px;
      padding: 8px;
      cursor: pointer;
      box-shadow: 0 3px 8px rgba(15,23,42,0.08);
      transition: transform 0.12s ease, box-shadow 0.12s ease,
        background 0.12s ease;
      font-size: 12px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .subject-card:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(15,23,42,0.12);
      background: #eef3ff;
    }

    .subject-card.active {
      outline: 2px solid var(--primary);
      outline-offset: 1px;
    }

    .subject-pill {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(76,201,240,0.18);
      color: #0077b6;
      align-self: flex-start;
    }

    .subject-main {
      font-size: 13px;
      font-weight: 600;
    }

    .subject-sub {
      font-size: 11px;
      opacity: 0.7;
    }

    .tag-row {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      margin-top: 4px;
    }

    .tiny-tag {
      font-size: 10px;
      padding: 1px 6px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.18);
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      background: #edf2ff;
      border-radius: 999px;
      overflow: hidden;
      margin-top: 4px;
    }

    .progress-fill {
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, #ff7b54, #ffb347);
      border-radius: inherit;
      transition: width 0.3s ease;
    }

    .progress-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 11px;
      margin-top: 2px;
      opacity: 0.75;
      flex-wrap: wrap;
      gap: 4px;
    }

    .lesson-meta {
      font-size: 11px;
      opacity: 0.75;
      display: flex;
      justify-content: space-between;
      gap: 6px;
      margin-bottom: 6px;
      flex-wrap: wrap;
    }

    .topic-list {
      margin-bottom: 8px;
      border-radius: 12px;
      background: #f9fafb;
      padding: 6px;
      max-height: 120px;
      overflow-y: auto;
    }

    .topic-item {
      font-size: 12px;
      padding: 4px 6px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      gap: 6px;
    }

    .topic-item:hover {
      background: rgba(148,163,184,0.12);
    }

    .topic-item.active {
      background: rgba(76,201,240,0.12);
      font-weight: 600;
    }

    .lesson-title {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .lesson-body {
      font-size: 13px;
      line-height: 1.45;
      margin-bottom: 8px;
      white-space: pre-wrap;
    }

    .qa-section {
      margin-top: 6px;
      padding-top: 6px;
      border-top: 1px dashed #e5e7eb;
    }

    .quiz-question {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .option-btn {
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      padding: 7px 10px;
      font-size: 12px;
      background: #ffffff;
      text-align: left;
      cursor: pointer;
      transition: background 0.12s ease, border-color 0.12s ease,
        transform 0.12s ease, box-shadow 0.12s ease;
    }

    .option-btn:hover {
      background: #f9fafb;
      transform: translateY(-1px);
      box-shadow: 0 3px 7px rgba(15,23,42,0.12);
    }

    .option-btn.correct {
      background: #e6ffed;
      border-color: #22c55e;
    }

    .option-btn.wrong {
      background: #fee2e2;
      border-color: #ef4444;
    }

    .controls-row {
      display: flex;
      gap: 6px;
      margin-top: 6px;
      flex-wrap: wrap;
    }

    .btn-main, .btn-secondary {
      border-radius: 999px;
      border: none;
      padding: 7px 11px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      white-space: nowrap;
    }

    .btn-main {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: #fff;
      box-shadow: 0 4px 10px rgba(255,123,84,0.5);
    }

    .btn-secondary {
      background: #eef2ff;
      color: #111827;
    }

    .status-row {
      display: flex;
      justify-content: space-between;
      margin-top: 6px;
      font-size: 11px;
      opacity: 0.75;
      flex-wrap: wrap;
      gap: 4px;
    }

    .status-pill {
      padding: 5px 9px;
      border-radius: 999px;
      background: rgba(255,255,255,0.9);
      box-shadow: 0 3px 8px rgba(15,23,42,0.08);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
    }

    .dot-online {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #22c55e;
    }

    .tiny {
      font-size: 10px;
      opacity: 0.65;
    }

    /* AI Assistant UI */

    .ai-fab {
      position: fixed;
      bottom: 16px;
      right: 16px;
      z-index: 9999;
    }

    .ai-fab button {
      border: none;
      border-radius: 999px;
      padding: 10px 16px;
      font-size: 13px;
      font-weight: 600;
      background: linear-gradient(135deg, #ffb347, #ff7b54);
      color: #fff;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.25);
      cursor: pointer;
    }

    .ai-fab button span.icon {
      font-size: 18px;
    }

    .ai-modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15,23,42,0.3);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9998;
    }

    .ai-modal {
      width: 100%;
      max-width: 720px;
      max-height: 90vh;
      background: var(--ai-bg);
      border-radius: 20px;
      border: 1px solid var(--ai-border);
      box-shadow: 0 20px 40px rgba(15,23,42,0.35);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .ai-modal-header {
      padding: 10px 14px;
      border-bottom: 1px solid #ffe0b2;
      background: #fff4e0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .ai-modal-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .ai-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: #ffd1a8;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }

    .ai-meta h3 {
      font-size: 14px;
      font-weight: 700;
    }

    .ai-meta p {
      font-size: 11px;
      opacity: 0.75;
    }

    .ai-modal-right {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 11px;
    }

    .ai-status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #22c55e;
    }

    .ai-btn-ghost {
      border: none;
      background: transparent;
      font-size: 16px;
      cursor: pointer;
    }

    .ai-modal-body {
      padding: 8px 14px 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      height: 100%;
    }

    .ai-toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 11px;
      align-items: center;
    }

    .ai-chip-btn {
      border-radius: 999px;
      border: 1px dashed #f59e0b;
      padding: 4px 8px;
      background: #fffaf0;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
    }

    .ai-chip-btn input[type="file"] {
      display: none;
    }

    .ai-url-input {
      flex: 1;
      min-width: 140px;
      padding: 5px 8px;
      border-radius: 999px;
      border: 1px solid #facc6b;
      font-size: 11px;
      background: #fffaf0;
    }

    .ai-url-button {
      border-radius: 999px;
      border: none;
      padding: 5px 8px;
      font-size: 11px;
      background: #fbbf24;
      color: #111827;
      cursor: pointer;
      white-space: nowrap;
    }

    .ai-chat {
      flex: 1;
      min-height: 160px;
      max-height: 340px;
      background: #fffdf8;
      border-radius: 14px;
      border: 1px solid #ffe0b2;
      padding: 8px;
      overflow-y: auto;
      font-size: 12px;
    }

    .ai-message-row {
      display: flex;
      margin-bottom: 6px;
      gap: 6px;
    }

    .ai-message-row.user {
      justify-content: flex-end;
    }

    .ai-message-bubble {
      max-width: 80%;
      padding: 6px 9px;
      border-radius: 12px;
      line-height: 1.4;
    }

    .ai-message-row.user .ai-message-bubble {
      background: #dbeafe;
      border-bottom-right-radius: 2px;
    }

    .ai-message-row.assistant .ai-message-bubble {
      background: #fff4e0;
      border-bottom-left-radius: 2px;
    }

    .ai-input-row {
      margin-top: 6px;
      display: flex;
      gap: 6px;
      align-items: flex-end;
    }

    .ai-textarea {
      flex: 1;
      min-height: 40px;
      max-height: 80px;
      padding: 6px 8px;
      border-radius: 12px;
      border: 1px solid #facc6b;
      font-size: 12px;
      resize: vertical;
      background: #fffdf8;
    }

    .ai-send-btn {
      border-radius: 999px;
      border: none;
      padding: 7px 11px;
      font-size: 12px;
      font-weight: 600;
      background: linear-gradient(135deg, #f97316, #f97316);
      color: #fff;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      white-space: nowrap;
    }

    .ai-helper-note {
      font-size: 10px;
      opacity: 0.7;
      margin-top: 2px;
    }

    @media (max-width: 768px) {
      .ai-modal {
        max-width: 96vw;
      }
    }

    /* --- Inspiring Wisdom Sidebar --- */

.wisdom-toggle {
  position: fixed;
  top: 50%;
  left: 4px;
  transform: translateY(-50%);
  z-index: 9998;
  background: linear-gradient(135deg, #6366f1, #8b5cf6);
  color: #fff;
  padding: 8px 10px;
  border-radius: 999px;
  font-size: 11px;
  font-weight: 600;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  cursor: pointer;
  box-shadow: 0 6px 16px rgba(15, 23, 42, 0.3);
}

.wisdom-toggle span.icon {
  font-size: 16px;
}

.wisdom-panel {
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 320px;
  max-width: 88vw;
  background: #0f172a;
  color: #e5e7eb;
  z-index: 9997;
  box-shadow: 4px 0 20px rgba(0,0,0,0.5);
  transform: translateX(-100%);
  transition: transform 0.25s ease-out;
  display: flex;
  flex-direction: column;
}

.wisdom-panel.open {
  transform: translateX(0);
}

.wisdom-header {
  padding: 10px 12px;
  border-bottom: 1px solid rgba(148,163,184,0.4);
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
}

.wisdom-header-left {
  display: flex;
  flex-direction: column;
}

.wisdom-title-main {
  font-size: 14px;
  font-weight: 700;
}

.wisdom-title-sub {
  font-size: 11px;
  opacity: 0.7;
}

.wisdom-header-right {
  display: flex;
  align-items: center;
  gap: 6px;
}

.wisdom-lang-select {
  font-size: 11px;
  padding: 3px 6px;
  border-radius: 999px;
  border: 1px solid rgba(148,163,184,0.8);
  background: #020617;
  color: #e5e7eb;
}

.wisdom-close-btn {
  border: none;
  background: transparent;
  color: #e5e7eb;
  font-size: 16px;
  cursor: pointer;
}

.wisdom-body {
  flex: 1;
  display: grid;
  grid-template-rows: minmax(0, 1.3fr) minmax(0, 2fr);
  gap: 6px;
  padding: 8px 10px 10px;
  font-size: 12px;
}

.wisdom-list {
  overflow-y: auto;
  border-radius: 10px;
  background: rgba(15,23,42,0.9);
  border: 1px solid rgba(148,163,184,0.4);
}

.wisdom-item {
  padding: 6px 8px;
  border-bottom: 1px solid rgba(30,41,59,0.9);
  cursor: pointer;
}

.wisdom-item:last-child {
  border-bottom: none;
}

.wisdom-item-title {
  font-weight: 600;
}

.wisdom-item-meta {
  font-size: 11px;
  opacity: 0.7;
}

.wisdom-item.active {
  background: linear-gradient(90deg, rgba(129,140,248,0.4), rgba(56,189,248,0.25));
}

.wisdom-content {
  overflow-y: auto;
  border-radius: 10px;
  background: rgba(15,23,42,0.95);
  border: 1px solid rgba(148,163,184,0.5);
  padding: 8px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.wisdom-story-title {
  font-size: 13px;
  font-weight: 700;
}

.wisdom-story-meta {
  font-size: 11px;
  opacity: 0.7;
}

.wisdom-section-label {
  font-size: 11px;
  font-weight: 600;
  opacity: 0.8;
  margin-top: 4px;
}

.wisdom-story-text,
.wisdom-reflection,
.wisdom-challenge {
  font-size: 12px;
  line-height: 1.4;
  white-space: pre-wrap;
}

.wisdom-footer {
  margin-top: 4px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
}

.wisdom-audio-btn {
  border-radius: 999px;
  border: 1px solid rgba(248,250,252,0.7);
  background: #111827;
  color: #f9fafb;
  font-size: 11px;
  padding: 5px 8px;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  cursor: pointer;
}

.wisdom-theme-pill {
  font-size: 10px;
  padding: 3px 7px;
  border-radius: 999px;
  background: rgba(148,163,184,0.3);
}

  </style>
</head>
<body>
  <div class="app-shell">
    <header>
      <div class="brand">
        <div class="logo-circle">FS</div>
        <div class="brand-text">
          <h1 id="appTitle">Future-Ready Skills</h1>
          <p id="appSubtitle">Class 1‚Äì12 ‚Ä¢ Skills + AI ‚Ä¢ Job-ready from day one</p>
        </div>
      </div>
      <div class="top-actions">
        <div class="chip">
          <span>üì¥</span><span id="offlineLabel">Offline-ready</span>
        </div>
        <div class="chip" id="onlineChip" style="display:none;">
          <span>üåê</span><span>Online AI & web tools</span>
        </div>
        <select id="languageSelect" class="lang-select">
          <option value="en">English UI</option>
          <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä UI</option>
          <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å UI</option>
        </select>
      </div>
    </header>

    <!-- LEFT PANEL -->
    <section class="panel panel-left">
      <div>
        <h2 id="classHeading">Choose your Class</h2>
        <p class="subtitle" id="classSubtitle">Start skills journey from Class 1. Tap a class below.</p>
        <div class="grid-classes" id="classGrid"></div>
      </div>

      <div>
        <h2 id="subjectHeading">Skill Tracks & Subjects</h2>
        <p class="subtitle" id="subjectSubtitle">Academic + skills + AI tracks for your chosen class.</p>
        <div class="subjects-row" id="subjectsRow"></div>
      </div>

      <div>
        <div class="progress-bar">
          <div id="overallProgressFill" class="progress-fill"></div>
        </div>
        <div class="progress-row">
          <span id="overallProgressLabel">No lessons completed yet.</span>
          <span id="overallScoreLabel">Average score: 0%</span>
        </div>
      </div>
    </section>

    <!-- RIGHT PANEL -->
    <section class="panel panel-right">
      <div>
        <h2 id="topicHeading">Topics, Skills & AI</h2>
        <p class="subtitle" id="topicSubtitle">
          Each topic blends concepts + AI tools + real-world application + money skills.
        </p>
      </div>

      <div class="lesson-meta">
        <span id="metaClass">Class ‚Äì</span>
        <span id="metaSubject">Track ‚Äì</span>
        <span id="metaTopicCount">0 topics</span>
      </div>

      <!-- World Languages controls -->
      <div class="lesson-meta" id="langPairControls" style="display:none; margin-top:-4px;">
        <span style="font-size:11px;">I know:</span>
        <select id="knownLangSelect" style="font-size:11px; padding:3px 6px; border-radius:999px; border:1px solid #e5e7eb;"></select>
        <span style="font-size:11px;">I want to learn:</span>
        <select id="targetLangSelect" style="font-size:11px; padding:3px 6px; border-radius:999px; border:1px solid #e5e7eb;"></select>
      </div>

      <div class="topic-list" id="topicList"></div>

      <div id="lessonArea">
        <div class="lesson-title" id="lessonTitle">Start by choosing a skill track.</div>
        <div class="lesson-body" id="lessonBody">
          Once you pick a track and topic, you‚Äôll see:
          ‚Ä¢ Concept in simple words
          ‚Ä¢ How AI/LLMs connect
          ‚Ä¢ Real-world application
          ‚Ä¢ Project idea that can earn or help others
        </div>

        <div class="qa-section" id="qaSection" style="display:none;">
          <div class="quiz-question" id="quizQuestion"></div>
          <div class="options" id="optionsContainer"></div>

          <div class="controls-row">
            <button class="btn-secondary" id="speakLessonBtn">üîä Speak</button>
            <button class="btn-secondary" id="speakQuestionBtn">üîä Speak Q</button>
            <button class="btn-main" id="nextQuestionBtn">Next Checkpoint ‚ûú</button>
          </div>
        </div>
      </div>

      <div class="status-row">
        <div class="status-pill">
          <div class="dot-online" id="dotOnline"></div>
          <span id="progressPillText">0 lessons ‚Ä¢ 0 quizzes ‚Ä¢ 0% avg</span>
        </div>
        <span class="tiny" id="storageNote">All progress is stored only on this device. No login needed.</span>
      </div>
    </section>
  </div>

  <!-- AI Assistant Floating Button -->
  <div class="ai-fab">
    <button id="openAiBtn">
      <span class="icon">ü§ñ</span>
      <span>AI Helper</span>
    </button>
  </div>

  <!-- AI Assistant Modal -->
  <div class="ai-modal-backdrop" id="aiBackdrop">
    <div class="ai-modal">
      <div class="ai-modal-header">
        <div class="ai-modal-left">
          <div class="ai-avatar">üí°</div>
          <div class="ai-meta">
            <h3>Comet AI Tutor</h3>
            <p id="aiStatusLine">Hybrid: offline knowledge + online AI when available</p>
          </div>
        </div>
        <div class="ai-modal-right">
          <div class="ai-status-dot" id="aiStatusDot"></div>
          <span id="aiOnlineStatusText">Online</span>
          <button class="ai-btn-ghost" id="closeAiBtn" title="Close">‚úñ</button>
        </div>
      </div>

      <div class="ai-modal-body">
        <div class="ai-toolbar">
          <label class="ai-chip-btn">
            üìé File
            <input type="file" id="aiFileInput" multiple />
          </label>

          <input type="text" id="aiUrlInput" class="ai-url-input" placeholder="Paste YouTube / website URL..." />

          <button class="ai-url-button" id="aiUrlAnalyzeBtn">Analyze URL</button>
        </div>

        <div class="ai-chat" id="aiChat"></div>

        <div class="ai-input-row">
          <textarea id="aiTextInput" class="ai-textarea" placeholder="Ask anything: skills, AI, projects, money, life..."></textarea>
          <button class="ai-send-btn" id="aiSendBtn">Send ‚ûú</button>
        </div>
        <div class="ai-helper-note">
          Offline: uses built-in skills syllabus. Online: uses a free OpenRouter AI model (after you add API key in code).
        </div>
      </div>
    </div>
  </div>


    <!-- Inspiring Wisdom Sidebar -->
  <div class="wisdom-toggle" id="wisdomToggle">
    <span class="icon">üåü</span>
    <span>Wisdom</span>
  </div>

  <div class="wisdom-panel" id="wisdomPanel">
    <div class="wisdom-header">
      <div class="wisdom-header-left">
        <div class="wisdom-title-main" id="wisdomTitleMain">Inspiring Wisdom</div>
        <div class="wisdom-title-sub" id="wisdomTitleSub">
          Leaders + scriptures ‚Ä¢ Unity ‚Ä¢ Character
        </div>
      </div>
      <div class="wisdom-header-right">
        <select id="wisdomLangSelect" class="wisdom-lang-select">
          <option value="en">English</option>
          <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
          <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
          <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
          <option value="es">Espa√±ol</option>
          <option value="fr">Fran√ßais</option>
        </select>
        <button class="wisdom-close-btn" id="wisdomCloseBtn" title="Close">‚úñ</button>
      </div>
    </div>

    <div class="wisdom-body">
      <div class="wisdom-list" id="wisdomList"></div>

      <div class="wisdom-content">
        <div class="wisdom-story-title" id="wisdomStoryTitle">
          Choose a story on the left.
        </div>
        <div class="wisdom-story-meta" id="wisdomStoryMeta"></div>

        <div class="wisdom-section-label" id="wisdomStoryLabel">Story</div>
        <div class="wisdom-story-text" id="wisdomStoryText">
          You‚Äôll see short stories of how leaders and everyday people used
          inner values, courage and wisdom from different traditions to
          handle real-life challenges.
        </div>

        <div class="wisdom-section-label" id="wisdomReflectionLabel">Reflection</div>
        <div class="wisdom-reflection" id="wisdomReflectionText">
          After reading, pause and ask: ‚ÄúWhat would I do in this situation?‚Äù
        </div>

        <div class="wisdom-section-label" id="wisdomChallengeLabel">Action Challenge</div>
        <div class="wisdom-challenge" id="wisdomChallengeText">
          Pick one small action today that shows kindness, honesty or courage.
        </div>

        <div class="wisdom-footer">
          <button class="wisdom-audio-btn" id="wisdomAudioBtn">
            üîä Listen to story
          </button>
          <span class="wisdom-theme-pill" id="wisdomThemePill">
            Compassion ‚Ä¢ Duty ‚Ä¢ Resilience
          </span>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ---------- UI Language Text ----------
    var uiText = {
      en: {
        title: "Future-Ready Skills",
        subtitle: "Class 1‚Äì12 ‚Ä¢ Skills + AI ‚Ä¢ Job-ready from day one",
        classHeading: "Choose your Class",
        classSubtitle: "Start your skill journey from Class 1.",
        subjectHeading: "Skill Tracks & Subjects",
        subjectSubtitle: "Academic + power skills + AI in every topic.",
        topicHeading: "Topics, Skills & AI",
        topicSubtitle: "Each topic links to AI, real work and projects.",
        offlineReady: "Offline-ready",
        noLessons: "No lessons completed yet.",
        avgScore: function (s) { return "Average score: " + s + "%"; },
        progressPill: function (l, q, a) { return l + " lessons \u2022 " + q + " quizzes \u2022 " + a + "% avg"; },
        storageNote: "All progress is stored only on this device. No login needed.",
        startTitle: "Start by choosing a skill track.",
        startBody:
"Once you pick a track and topic, you‚Äôll see:\n‚Ä¢ Concept in simple words\n‚Ä¢ How AI/LLMs connect\n‚Ä¢ Real-world application\n‚Ä¢ Project idea that can earn or help others"
      },
      hi: {
        title: "‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø-‡§™‡•ç‡§∞‡§ß‡§æ‡§® ‡§ï‡•å‡§∂‡§≤",
        subtitle: "‡§ï‡§ï‡•ç‡§∑‡§æ 1‚Äì12 ‚Ä¢ ‡§ï‡•å‡§∂‡§≤ + ‡§è‡§Ü‡§à ‚Ä¢ ‡§ú‡•â‡§¨-‡§∞‡•á‡§°‡•Ä ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡•Ä",
        classHeading: "‡§Ö‡§™‡§®‡•Ä ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç",
        classSubtitle: "‡§ï‡§ï‡•ç‡§∑‡§æ 1 ‡§∏‡•á ‡§π‡•Ä ‡§ï‡•å‡§∂‡§≤ ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç‡•§",
        subjectHeading: "‡§∏‡•ç‡§ï‡§ø‡§≤ ‡§ü‡•ç‡§∞‡•à‡§ï‡•ç‡§∏ ‡§î‡§∞ ‡§µ‡§ø‡§∑‡§Ø",
        subjectSubtitle: "‡§∂‡•à‡§ï‡•ç‡§∑‡§£‡§ø‡§ï + ‡§™‡§æ‡§µ‡§∞ ‡§∏‡•ç‡§ï‡§ø‡§≤ + ‡§π‡§∞ ‡§ü‡•â‡§™‡§ø‡§ï ‡§Æ‡•á‡§Ç ‡§è‡§Ü‡§à‡•§",
        topicHeading: "‡§ü‡•â‡§™‡§ø‡§ï, ‡§∏‡•ç‡§ï‡§ø‡§≤ ‡§î‡§∞ ‡§è‡§Ü‡§à",
        topicSubtitle: "‡§π‡§∞ ‡§ü‡•â‡§™‡§ø‡§ï ‡§ï‡•ã ‡§è‡§Ü‡§à, ‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï ‡§ú‡•Ä‡§µ‡§® ‡§î‡§∞ ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§∏‡•á ‡§ú‡•ã‡§°‡§º‡§§‡•á ‡§π‡•à‡§Ç‡•§",
        offlineReady: "‡§ë‡§´‡§º‡§≤‡§æ‡§á‡§® ‡§§‡•à‡§Ø‡§æ‡§∞",
        noLessons: "‡§Ö‡§≠‡•Ä ‡§ï‡•ã‡§à ‡§™‡§æ‡§† ‡§™‡•Ç‡§∞‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§Ü‡•§",
        avgScore: function (s) { return "‡§î‡§∏‡§§ ‡§Ö‡§Ç‡§ï: " + s + "%"; },
        progressPill: function (l, q, a) { return l + " ‡§™‡§æ‡§† \u2022 " + q + " ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º \u2022 " + a + "% ‡§î‡§∏‡§§"; },
        storageNote: "‡§∏‡§æ‡§∞‡•Ä ‡§™‡•ç‡§∞‡§ó‡§§‡§ø ‡§ï‡•á‡§µ‡§≤ ‡§á‡§∏ ‡§°‡§ø‡§µ‡§æ‡§á‡§∏ ‡§™‡§∞ ‡§∏‡•á‡§µ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§ ‡§ï‡§ø‡§∏‡•Ä ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡•Ä ‡§ú‡§º‡§∞‡•Ç‡§∞‡§§ ‡§®‡§π‡•Ä‡§Ç‡•§",
        startTitle: "‡§™‡§π‡§≤‡•á ‡§ï‡•ã‡§à ‡§∏‡•ç‡§ï‡§ø‡§≤ ‡§ü‡•ç‡§∞‡•à‡§ï ‡§ö‡•Å‡§®‡•á‡§Ç‡•§",
        startBody:
"‡§ú‡•à‡§∏‡•á ‡§π‡•Ä ‡§Ü‡§™ ‡§ü‡•ç‡§∞‡•à‡§ï ‡§î‡§∞ ‡§ü‡•â‡§™‡§ø‡§ï ‡§ö‡•Å‡§®‡•á‡§Ç‡§ó‡•á, ‡§Ü‡§™‡§ï‡•ã ‡§Æ‡§ø‡§≤‡•á‡§ó‡§æ:\n‚Ä¢ ‡§∏‡§∞‡§≤ ‡§≠‡§æ‡§∑‡§æ ‡§Æ‡•á‡§Ç ‡§ï‡•â‡§®‡•ç‡§∏‡•á‡§™‡•ç‡§ü\n‚Ä¢ ‡§è‡§Ü‡§à/‡§è‡§≤‡§è‡§≤‡§è‡§Æ ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß\n‚Ä¢ ‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï ‡§ú‡•Ä‡§µ‡§® ‡§Æ‡•á‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó\n‚Ä¢ ‡§ê‡§∏‡§æ ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§ú‡•ã ‡§ï‡§Æ‡§æ‡§à ‡§Ø‡§æ ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡•á"
      },
      te: {
        title: "‡∞´‡±ç‡∞Ø‡±Ç‡∞ö‡∞∞‡±ç ‡∞∞‡±Ü‡∞°‡±Ä ‡∞∏‡±ç‡∞ï‡∞ø‡∞≤‡±ç‡∞∏‡±ç",
        subtitle: "1‚Äì12 ‡∞§‡∞∞‡∞ó‡∞§‡±Å‡∞≤‡±Å ‚Ä¢ ‡∞∏‡±ç‡∞ï‡∞ø‡∞≤‡±ç‡∞∏‡±ç + ‡∞è‡∞ê ‚Ä¢ ‡∞ú‡∞æ‡∞¨‡±ç-‡∞∞‡±Ü‡∞°‡±Ä ‡∞∏‡±ç‡∞ü‡±Ç‡∞°‡±Ü‡∞Ç‡∞ü‡±ç‡∞∏‡±ç",
        classHeading: "‡∞Æ‡±Ä ‡∞ï‡±ç‡∞≤‡∞æ‡∞∏‡±ç ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø",
        classSubtitle: "1‡∞µ ‡∞§‡∞∞‡∞ó‡∞§‡∞ø ‡∞®‡±Å‡∞Ç‡∞ö‡±á ‡∞∏‡±ç‡∞ï‡∞ø‡∞≤‡±ç ‡∞ú‡∞∞‡±ç‡∞®‡±Ä ‡∞™‡±ç‡∞∞‡∞æ‡∞∞‡∞Ç‡∞≠‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø.",
        subjectHeading: "‡∞∏‡±ç‡∞ï‡∞ø‡∞≤‡±ç ‡∞ü‡±ç‡∞∞‡∞æ‡∞ï‡±ç‡∞∏‡±ç & ‡∞∏‡∞¨‡±ç‡∞ú‡±Ü‡∞ï‡±ç‡∞ü‡±ç‡∞∏‡±ç",
        subjectSubtitle: "‡∞Ö‡∞ï‡∞æ‡∞°‡±Ü‡∞Æ‡∞ø‡∞ï‡±ç + ‡∞™‡∞µ‡∞∞‡±ç ‡∞∏‡±ç‡∞ï‡∞ø‡∞≤‡±ç‡∞∏‡±ç + ‡∞™‡±ç‡∞∞‡∞§‡∞ø ‡∞ü‡∞æ‡∞™‡∞ø‡∞ï‡±ç‚Äå‡∞≤‡±ã ‡∞è‡∞ê.",
        topicHeading: "‡∞ü‡∞æ‡∞™‡∞ø‡∞ï‡±ç‡∞∏‡±ç, ‡∞∏‡±ç‡∞ï‡∞ø‡∞≤‡±ç‡∞∏‡±ç & ‡∞è‡∞ê",
        topicSubtitle: "‡∞™‡±ç‡∞∞‡∞§‡∞ø ‡∞ü‡∞æ‡∞™‡∞ø‡∞ï‡±ç‚Äå‡∞®‡±Å ‡∞è‡∞ê, ‡∞∞‡∞ø‡∞Ø‡∞≤‡±ç ‡∞≤‡±à‡∞´‡±ç, ‡∞™‡±ç‡∞∞‡∞æ‡∞ú‡±Ü‡∞ï‡±ç‡∞ü‡±ç‚Äå‡∞§‡±ã ‡∞ï‡∞≤‡±Å‡∞™‡±Å‡∞§‡∞æ‡∞Ç.",
        offlineReady: "‡∞Ü‡∞´‡±ç‡∞≤‡±à‡∞®‡±ç ‡∞∏‡∞ø‡∞¶‡±ç‡∞ß‡∞Ç‡∞ó‡∞æ",
        noLessons: "‡∞á‡∞Ç‡∞ï‡∞æ ‡∞è ‡∞™‡∞æ‡∞†‡∞Ç ‡∞™‡±Ç‡∞∞‡±ç‡∞§‡∞ø‡∞ï‡∞æ‡∞≤‡±á‡∞¶‡±Å.",
        avgScore: function (s) { return "‡∞∏‡∞ó‡∞ü‡±Å ‡∞∏‡±ç‡∞ï‡±ã‡∞∞‡±ç: " + s + "%"; },
        progressPill: function (l, q, a) { return l + " ‡∞™‡∞æ‡∞†‡∞æ‡∞≤‡±Å \u2022 " + q + " ‡∞ï‡±ç‡∞µ‡∞ø‡∞ú‡±ç‚Äå‡∞≤‡±Å \u2022 " + a + "% ‡∞∏‡∞ó‡∞ü‡±Å"; },
        storageNote: "‡∞™‡±ç‡∞∞‡±ã‡∞ó‡±ç‡∞∞‡±Ü‡∞∏‡±ç ‡∞à ‡∞°‡∞ø‡∞µ‡±à‡∞∏‡±ç‚Äå‡∞≤‡±ã ‡∞Æ‡∞æ‡∞§‡±ç‡∞∞‡∞Æ‡±á ‡∞∏‡±á‡∞µ‡±ç ‡∞Ö‡∞µ‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø. ‡∞≤‡∞æ‡∞ó‡∞ø‡∞®‡±ç ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç ‡∞≤‡±á‡∞¶‡±Å.",
        startTitle: "‡∞Æ‡±ä‡∞¶‡∞ü ‡∞í‡∞ï ‡∞∏‡±ç‡∞ï‡∞ø‡∞≤‡±ç ‡∞ü‡±ç‡∞∞‡∞æ‡∞ï‡±ç ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø.",
        startBody:
"‡∞Æ‡±Ä‡∞∞‡±Å ‡∞ü‡±ç‡∞∞‡∞æ‡∞ï‡±ç, ‡∞ü‡∞æ‡∞™‡∞ø‡∞ï‡±ç ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±Å‡∞®‡±ç‡∞® ‡∞§‡∞∞‡±Å‡∞µ‡∞æ‡∞§ ‡∞Æ‡±Ä‡∞∞‡±Å ‡∞ö‡±Ç‡∞∏‡±ç‡∞§‡∞æ‡∞∞‡±Å:\n‚Ä¢ ‡∞∏‡∞ø‡∞Ç‡∞™‡±Å‡∞≤‡±ç‚Äå‡∞ó‡∞æ ‡∞ï‡∞æ‡∞®‡±ç‡∞∏‡±Ü‡∞™‡±ç‡∞ü‡±ç\n‚Ä¢ ‡∞è‡∞ê/‡∞é‡∞≤‡±ç‡∞é‡∞≤‡±ç‡∞é‡∞Æ‡±ç‚Äå‡∞§‡±ã ‡∞≤‡∞ø‡∞Ç‡∞ï‡±ç\n‚Ä¢ ‡∞∞‡∞ø‡∞Ø‡∞≤‡±ç ‡∞µ‡∞∞‡∞≤‡±ç‡∞°‡±ç ‡∞Ø‡±Ç‡∞ú‡±ç\n‚Ä¢ ‡∞°‡∞¨‡±ç‡∞¨‡±Å ‡∞∏‡∞Ç‡∞™‡∞æ‡∞¶‡∞ø‡∞Ç‡∞ö‡∞ó‡∞≤‡∞ø‡∞ó‡±á ‡∞≤‡±á‡∞¶‡∞æ ‡∞π‡±Ü‡∞≤‡±ç‡∞™‡±ç ‡∞ö‡±á‡∞∏‡±á ‡∞™‡±ç‡∞∞‡∞æ‡∞ú‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞ê‡∞°‡∞ø‡∞Ø‡∞æ"
      }
    };

    var currentLang = localStorage.getItem("fs_lang") || "en";

    // ---------- Supported Languages for World Languages Subject ----------
    var supportedLanguages = [
      { code: "en", name: "English", native: "English" },
      { code: "zh", name: "Mandarin Chinese", native: "‰∏≠Êñá" },
      { code: "hi", name: "Hindi", native: "‡§π‡§ø‡§®‡•ç‡§¶‡•Ä" },
      { code: "es", name: "Spanish", native: "Espa√±ol" },
      { code: "ar", name: "Arabic", native: "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©" },
      { code: "fr", name: "French", native: "Fran√ßais" },
      { code: "pt", name: "Portuguese (Brazil)", native: "Portugu√™s (BR)" },
      { code: "ru", name: "Russian", native: "–†—É—Å—Å–∫–∏–π" },
      { code: "ja", name: "Japanese", native: "Êó•Êú¨Ë™û" },
      { code: "de", name: "German", native: "Deutsch" },
      { code: "te", name: "Telugu", native: "‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å" }
    ];

       // ---------- Inspiring Wisdom (leaders + scriptures) ----------

// Simple multi-language UI labels (content stays in simple English, TTS can use different voices)
var wisdomUILang = localStorage.getItem("fs_wisdomLang") || "en";

var wisdomUIText = {
  en: {
    panelTitle: "Inspiring Wisdom",
    panelSub: "Leaders + scriptures ‚Ä¢ Unity ‚Ä¢ Character",
    storyLabel: "Story",
    reflectionLabel: "Reflection",
    challengeLabel: "Action Challenge",
    defaultReflection: "After reading, pause and ask: ‚ÄúWhat would I do in this situation?‚Äù",
    defaultChallenge: "Pick one small action today that shows kindness, honesty or courage.",
    themeDefault: "Compassion ‚Ä¢ Duty ‚Ä¢ Resilience"
  },
  hi: {
    panelTitle: "‡§™‡•ç‡§∞‡•á‡§∞‡§£‡§æ‡§¶‡§æ‡§Ø‡•Ä ‡§ú‡•ç‡§û‡§æ‡§®",
    panelSub: "‡§®‡•á‡§§‡§æ + ‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞ ‚Ä¢ ‡§è‡§ï‡§§‡§æ ‚Ä¢ ‡§ö‡§∞‡§ø‡§§‡•ç‡§∞",
    storyLabel: "‡§ï‡§π‡§æ‡§®‡•Ä",
    reflectionLabel: "‡§µ‡§ø‡§ö‡§æ‡§∞",
    challengeLabel: "‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ö‡•Å‡§®‡•å‡§§‡•Ä",
    defaultReflection: "‡§ï‡§π‡§æ‡§®‡•Ä ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§∏‡•ã‡§ö‡•á‡§Ç: ‚Äú‡§ê‡§∏‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§Æ‡•á‡§Ç ‡§Æ‡•à‡§Ç ‡§ï‡•ç‡§Ø‡§æ ‡§ï‡§∞‡§§‡§æ/‡§ï‡§∞‡§§‡•Ä?‚Äù",
    defaultChallenge: "‡§Ü‡§ú ‡§è‡§ï ‡§õ‡•ã‡§ü‡§æ ‡§ï‡§æ‡§Æ ‡§ö‡•Å‡§®‡•á‡§Ç ‡§ú‡•ã ‡§¶‡§Ø‡§æ, ‡§à‡§Æ‡§æ‡§®‡§¶‡§æ‡§∞‡•Ä ‡§Ø‡§æ ‡§∏‡§æ‡§π‡§∏ ‡§¶‡§ø‡§ñ‡§æ‡§è‡•§",
    themeDefault: "‡§ï‡§∞‡•Å‡§£‡§æ ‚Ä¢ ‡§ï‡§∞‡•ç‡§§‡§µ‡•ç‡§Ø ‚Ä¢ ‡§ß‡•à‡§∞‡•ç‡§Ø"
  },
  te: {
    panelTitle: "‡∞™‡±ç‡∞∞‡±á‡∞∞‡∞£‡∞æ‡∞§‡±ç‡∞Æ‡∞ï ‡∞ú‡±ç‡∞û‡∞æ‡∞®‡∞Ç",
    panelSub: "‡∞®‡∞æ‡∞Ø‡∞ï‡±Å‡∞≤‡±Å + ‡∞∂‡∞æ‡∞∏‡±ç‡∞§‡±ç‡∞∞‡∞æ‡∞≤‡±Å ‚Ä¢ ‡∞è‡∞ï‡∞§‡±ç‡∞µ‡∞Ç ‚Ä¢ ‡∞∏‡±ç‡∞µ‡∞≠‡∞æ‡∞µ‡∞Ç",
    storyLabel: "‡∞ï‡∞•",
    reflectionLabel: "‡∞Ü‡∞≤‡±ã‡∞ö‡∞®",
    challengeLabel: "‡∞ö‡∞∞‡±ç‡∞Ø ‡∞∏‡∞µ‡∞æ‡∞≤‡±Å",
    defaultReflection: "‡∞ï‡∞• ‡∞§‡∞∞‡±Å‡∞µ‡∞æ‡∞§ ‡∞Ü‡∞≤‡±ã‡∞ö‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø: ‚Äú‡∞á‡∞≤‡∞æ‡∞Ç‡∞ü‡∞ø ‡∞™‡∞∞‡∞ø‡∞∏‡±ç‡∞•‡∞ø‡∞§‡∞ø‡∞≤‡±ã ‡∞®‡±á‡∞®‡±Å ‡∞è‡∞Æ‡∞ø ‡∞ö‡±á‡∞∏‡±á‡∞µ‡∞æ‡∞°‡∞ø‡∞®‡∞ø?‚Äù",
    defaultChallenge: "‡∞à ‡∞∞‡±ã‡∞ú‡±Å ‡∞¶‡∞Ø, ‡∞®‡∞ø‡∞ú‡∞æ‡∞Ø‡∞ø‡∞§‡±Ä ‡∞≤‡±á‡∞¶‡∞æ ‡∞ß‡±à‡∞∞‡±ç‡∞Ø‡∞Ç ‡∞ö‡±Ç‡∞™‡±á ‡∞í‡∞ï ‡∞ö‡∞ø‡∞®‡±ç‡∞® ‡∞ö‡∞∞‡±ç‡∞Ø‡∞®‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø.",
    themeDefault: "‡∞ï‡∞∞‡±Å‡∞£ ‚Ä¢ ‡∞ï‡∞∞‡±ç‡∞§‡∞µ‡±ç‡∞Ø ‚Ä¢ ‡∞ß‡±à‡∞∞‡±ç‡∞Ø‡∞Ç"
  },
  ar: {
    panelTitle: "ÿ≠ŸÉŸÖÿ© ŸÖŸÑŸáŸÖÿ©",
    panelSub: "ŸÇÿßÿØÿ© + ŸÉÿ™ÿ® ÿ≥ŸÖÿßŸàŸäÿ© ‚Ä¢ Ÿàÿ≠ÿØÿ© ‚Ä¢ ÿ£ÿÆŸÑÿßŸÇ",
    storyLabel: "ŸÇÿµÿ©",
    reflectionLabel: "ÿ™ÿ£ŸÖŸÑ",
    challengeLabel: "ÿ™ÿ≠ÿØŸä ÿπŸÖŸÑŸä",
    defaultReflection: "ÿ®ÿπÿØ ÿßŸÑŸÇÿ±ÿßÿ°ÿ© ÿßÿ≥ÿ£ŸÑ ŸÜŸÅÿ≥ŸÉ: \"ŸÖÿßÿ∞ÿß ÿ≥ÿ£ŸÅÿπŸÑ ŸÑŸà ŸÉŸÜÿ™ ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑŸÖŸàŸÇŸÅÿü\"",
    defaultChallenge: "ÿßÿÆÿ™ÿ± ÿπŸÖŸÑŸãÿß ÿµÿ∫Ÿäÿ±Ÿãÿß ÿßŸÑŸäŸàŸÖ Ÿäÿ∏Ÿáÿ± ÿßŸÑŸÑÿ∑ŸÅ ÿ£Ÿà ÿßŸÑÿµÿØŸÇ ÿ£Ÿà ÿßŸÑÿ¥ÿ¨ÿßÿπÿ©.",
    themeDefault: "ÿ±ÿ≠ŸÖÿ© ‚Ä¢ Ÿàÿßÿ¨ÿ® ‚Ä¢ ÿµÿ®ÿ±"
  },
  es: {
    panelTitle: "Sabidur√≠a Inspiradora",
    panelSub: "L√≠deres + escrituras ‚Ä¢ Unidad ‚Ä¢ Car√°cter",
    storyLabel: "Historia",
    reflectionLabel: "Reflexi√≥n",
    challengeLabel: "Desaf√≠o de acci√≥n",
    defaultReflection: "Despu√©s de leer, preg√∫ntate: ‚Äú¬øQu√© har√≠a yo en esta situaci√≥n?‚Äù",
    defaultChallenge: "Elige hoy una peque√±a acci√≥n que muestre amabilidad, honestidad o valent√≠a.",
    themeDefault: "Compasi√≥n ‚Ä¢ Deber ‚Ä¢ Resiliencia"
  },
  fr: {
    panelTitle: "Sagesse Inspirante",
    panelSub: "Leaders + √©critures ‚Ä¢ Unit√© ‚Ä¢ Caract√®re",
    storyLabel: "Histoire",
    reflectionLabel: "R√©flexion",
    challengeLabel: "D√©fi d‚Äôaction",
    defaultReflection: "Apr√®s la lecture, demande-toi : ¬´ Que ferais-je dans cette situation ? ¬ª",
    defaultChallenge: "Choisis aujourd‚Äôhui une petite action qui montre la gentillesse, l‚Äôhonn√™tet√© ou le courage.",
    themeDefault: "Compassion ‚Ä¢ Devoir ‚Ä¢ R√©silience"
  }
};

// NOTE: Stories are written in simple English and described as teachings,
// not literal word-for-word quotes from scriptures.

var wisdomStories = [
  {
    id: "kalam-dreams",
    sourceType: "Leader",
    name: "Dr. APJ Abdul Kalam",
    title: "Dreams + Discipline in Difficult Times",
    ageRange: "10+",
    theme: "Dreams ‚Ä¢ Hard work ‚Ä¢ Service",
    context:
      "Young Kalam grew up in a simple home in Rameswaram. Money was limited, but his curiosity about rockets, science and the sky was limitless.",
    story:
      "Instead of feeling angry about what he did not have, Kalam focused on what he could control: reading extra, asking questions, helping others and staying disciplined.\n\nWhen college or work did not go exactly as planned, he did not stop. He used every failure as feedback. Later, as a scientist and President of India, he kept telling students that big dreams start in small rooms.",
    teaching:
      "Real success is not instant. It is daily discipline: study a little better, think a little deeper and serve a little more. Inner character matters more than outer comfort.",
    reflection:
      "‚Ä¢ What is one big dream you quietly carry?\n‚Ä¢ Are you letting your situation stop you, or using it as fuel to grow?\n‚Ä¢ Which daily habit can you improve by just 1%?",
    challenge:
      "Tonight, write one dream in a notebook. Under it, write one tiny daily action you can start from tomorrow (reading, practice, helping someone) and follow it for 7 days."
  },
  {
    id: "modi-service",
    sourceType: "Leader",
    name: "Shri Narendra Modi (Prime Minister of India)",
    title: "Service Mindset: Small Steps for People Around You",
    ageRange: "10+",
    theme: "Service ‚Ä¢ Discipline ‚Ä¢ Simplicity",
    context:
      "Many leaders speak about development in big words. But meaningful change starts with noticing small needs of real people around us.",
    story:
      "Stories shared about Narendra Modi‚Äôs early years describe him helping at a small tea stall, interacting with travellers and listening to many kinds of people.\n\nWhether or not we focus on politics, one useful lesson is: ordinary work can become a training ground for understanding people, learning discipline and serving with consistency.",
    teaching:
      "Any small responsibility ‚Äî in home, school or community ‚Äî can become a place to practice discipline, respect and service.",
    reflection:
      "‚Ä¢ What small responsibilities do you have every day?\n‚Ä¢ How can you turn one of them into a chance to serve better?\n‚Ä¢ How does listening carefully to people change your decisions?",
    challenge:
      "For one week, pick a simple duty (helping at home, keeping a class corner clean, guiding a younger student) and do it with extra care, without waiting for praise."
  },
  {
    id: "murmu-resilience",
    sourceType: "Leader",
    name: "President Droupadi Murmu",
    title: "Quiet Strength in the Face of Loss",
    ageRange: "12+",
    theme: "Resilience ‚Ä¢ Humility ‚Ä¢ Education",
    context:
      "President Murmu‚Äôs journey includes deep personal losses and many challenges, yet she continued to serve and learn.",
    story:
      "Coming from a tribal community and facing family tragedies, she still kept faith in education, public service and inner strength.\n\nInstead of letting grief close her heart, she allowed it to deepen her compassion for others who suffer silently.",
    teaching:
      "Resilience is not about never feeling pain. It is about allowing pain to make you more gentle, not more bitter.",
    reflection:
      "‚Ä¢ Have you seen someone stay kind even after difficulty?\n‚Ä¢ What helps you continue when life feels unfair?\n‚Ä¢ Who can you gently support today?",
    challenge:
      "Write the name of one person who is struggling (classmate, neighbour, relative). Do one small act of support: a message, a smile, helping with work or simply listening."
  },
  {
    id: "gita-duty",
    sourceType: "Scripture",
    name: "Bhagavad Gita (summarised idea)",
    title: "Doing Your Duty with a Calm Mind",
    ageRange: "12+",
    theme: "Duty ‚Ä¢ Clarity ‚Ä¢ Detachment",
    context:
      "In the Gita, Arjuna is confused and afraid on the battlefield of life, not sure how to act.",
    story:
      "The teaching often summarised from the Gita is: focus on the right action, not on controlling every result. When the mind is full of fear about success or failure, we avoid doing what is right.\n\nBy remembering your role and values, you act with sincerity and accept results with balance.",
    teaching:
      "Do your best work with honesty and courage, and let go of the obsession to control every outcome.",
    reflection:
      "‚Ä¢ Is there a decision you are avoiding because you fear failure?\n‚Ä¢ What would it look like to do the right thing, even if the result is not guaranteed?",
    challenge:
      "Choose one task you have been postponing (study, conversation, project). Do a 25-minute focused sprint today, just giving your best without worrying about the final mark."
  },
  {
    id: "upanishads-self",
    sourceType: "Scripture",
    name: "Upanishads (summarised idea)",
    title: "Seeing the Same Light in All",
    ageRange: "12+",
    theme: "Unity ‚Ä¢ Respect ‚Ä¢ Inner calm",
    context:
      "The Upanishads often speak about the deeper Self that is beyond labels like caste, country or role.",
    story:
      "One simple way to understand this is: there is a quiet light of awareness inside you that watches thoughts, emotions and roles. That same light exists in others.\n\nWhen we remember this, it becomes harder to hate and easier to listen.",
    teaching:
      "Real education is not only about information, but about seeing the shared humanity in everyone.",
    reflection:
      "‚Ä¢ When you are angry at someone, can you still remember they also feel pain and fear?\n‚Ä¢ How would your words change if you saw the same inner light in them?",
    challenge:
      "Pick one person you usually judge (online or offline). For one day, speak and act as if they carry the same inner light and dignity as you."
  },
  {
    id: "bible-good-samaritan",
    sourceType: "Scripture",
    name: "Bible (Good Samaritan ‚Äì summarised idea)",
    title: "Helping Beyond Labels",
    ageRange: "8+",
    theme: "Compassion ‚Ä¢ Service ‚Ä¢ Breaking prejudice",
    context:
      "In a famous teaching, a traveller is hurt on the road. Some people who are expected to help walk past him.",
    story:
      "A person from a group that was looked down upon chooses to stop, care and spend his own time and resources to help the stranger.\n\nThe idea is simple: real neighbourliness is shown not in words but in compassion across boundaries.",
    teaching:
      "Kindness that crosses labels (religion, caste, language, country) is a powerful form of spirituality.",
    reflection:
      "‚Ä¢ Have you ever ignored someone in need because they were 'not your group'?\n‚Ä¢ Who has been a hidden helper in your life?",
    challenge:
      "Today, look for one small chance to quietly help someone without expecting thanks ‚Äî maybe at school, on the road or at home."
  },
  {
    id: "quran-mercy",
    sourceType: "Scripture",
    name: "Quran (mercy and justice ‚Äì summarised idea)",
    title: "Balancing Mercy and Fairness",
    ageRange: "12+",
    theme: "Mercy ‚Ä¢ Justice ‚Ä¢ Self-control",
    context:
      "Many verses in the Quran emphasise compassion, justice and accountability before God.",
    story:
      "One practical takeaway: when you have some power ‚Äî even small, like being older or stronger ‚Äî you are invited to use it with fairness and mercy.\n\nAnger is natural, but guidance is to control it and choose what is just, not what is impulsive.",
    teaching:
      "True strength is shown by those who can control their anger and act fairly, especially when it would be easy to misuse power.",
    reflection:
      "‚Ä¢ When was the last time you reacted in anger and later regretted it?\n‚Ä¢ How could pausing for a few breaths have changed the situation?",
    challenge:
      "For the next 3 days, whenever you feel anger rising, pause for 5 slow breaths before speaking. Notice how your choice of words changes."
  }
];


    var languagePhrases = [
      {
        key: "hello",
        concept: "Basic greeting: Hello",
        translations: {
          en: "Hello",
          zh: "‰Ω†Â•Ω",
          hi: "‡§®‡§Æ‡§∏‡•ç‡§§‡•á",
          es: "Hola",
          ar: "ŸÖÿ±ÿ≠ÿ®ÿß",
          fr: "Bonjour",
          pt: "Ol√°",
          ru: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ",
          ja: "„Åì„Çì„Å´„Å°„ÅØ",
          de: "Hallo",
          te: "‡∞®‡∞Æ‡∞∏‡±ç‡∞§‡±á"
        }
      },
      {
        key: "thank_you",
        concept: "Polite phrase: Thank you",
        translations: {
          en: "Thank you",
          zh: "Ë∞¢Ë∞¢",
          hi: "‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶",
          es: "Gracias",
          ar: "ÿ¥ŸÉÿ±ÿß",
          fr: "Merci",
          pt: "Obrigado / Obrigada",
          ru: "–°–ø–∞—Å–∏–±–æ",
          ja: "„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô",
          de: "Danke",
          te: "‡∞ß‡∞®‡±ç‡∞Ø‡∞µ‡∞æ‡∞¶‡∞æ‡∞≤‡±Å"
        }
      },
      {
        key: "please",
        concept: "Polite phrase: Please",
        translations: {
          en: "Please",
          zh: "ËØ∑",
          hi: "‡§ï‡•É‡§™‡§Ø‡§æ",
          es: "Por favor",
          ar: "ŸÖŸÜ ŸÅÿ∂ŸÑŸÉ",
          fr: "S'il vous pla√Æt",
          pt: "Por favor",
          ru: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞",
          ja: "„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô",
          de: "Bitte",
          te: "‡∞¶‡∞Ø‡∞ö‡±á‡∞∏‡∞ø"
        }
      },
      {
        key: "how_are_you",
        concept: "Common question: How are you?",
        translations: {
          en: "How are you?",
          zh: "‰Ω†Â•ΩÂêóÔºü",
          hi: "‡§Ü‡§™ ‡§ï‡•à‡§∏‡•á ‡§π‡•à‡§Ç?",
          es: "¬øC√≥mo est√°s?",
          ar: "ŸÉŸäŸÅ ÿ≠ÿßŸÑŸÉÿü",
          fr: "Comment √ßa va ?",
          pt: "Como vai voc√™?",
          ru: "–ö–∞–∫ –¥–µ–ª–∞?",
          ja: "„ÅäÂÖÉÊ∞ó„Åß„Åô„ÅãÔºü",
          de: "Wie geht es dir?",
          te: "‡∞Æ‡±Ä‡∞∞‡±Å ‡∞é‡∞≤‡∞æ ‡∞â‡∞®‡±ç‡∞®‡∞æ‡∞∞‡±Å?"
        }
      }
    ];

    // ---------- Shared Tracks ----------
    var superLearning = {
      subjectLabel: "Super Learning & Brain Skills",
      level: "All classes",
      topics: [
        {
          id: "sl-active-recall",
          title: "Active Recall + AI: Study Faster",
          level: "Core skill",
          body:
"Concept:\nActive recall means closing the book and testing yourself instead of only re-reading.\n\nAI Connection:\n‚Ä¢ Class 1‚Äì5: Ask Comet: ‚ÄúExplain this in simple words, then hide it and let me recall.‚Äù\n‚Ä¢ Class 6‚Äì8: Use an AI tool to generate practice questions and answer them without looking.\n‚Ä¢ Class 9‚Äì12: Ask AI to create exam-style questions and try to answer before looking at suggestions.\n\nReal-World Application:\nYou learn faster than others, clear exams with less time, and free up time to build skills / projects.\n\nMini Project:\nPick any chapter, ask Comet AI to generate 5 questions, write answers in a notebook from memory, then compare.",
          quiz: {
            question: "What is the main idea of active recall?",
            options: [
              "Reading the same page 10 times",
              "Testing yourself without seeing the book",
              "Only watching videos",
              "Highlighting with 5 colours"
            ],
            answerIndex: 1
          }
        },
        {
          id: "sl-ai-mindset",
          title: "AI Mindset: Human + AI > AI alone",
          level: "Core skill",
          body:
"Concept:\nAI is a powerful assistant, not a replacement for your brain. You ask good questions, AI gives ideas, you decide.\n\nAI/LLM Connection:\n‚Ä¢ A Large Language Model (LLM) like ChatGPT or Comet reads huge amounts of text and predicts the ‚Äúnext best word‚Äù.\n‚Ä¢ It does NOT truly understand life like a human. You provide direction, values and judgement.\n\nReal-World Application:\n‚Ä¢ You can work faster than people who don‚Äôt know AI.\n‚Ä¢ You can earn by combining your thinking + AI speed (content, code, design, marketing).\n\nMini Project:\nWrite one problem you have (study, money, time). Ask Comet AI for 3 solutions. Choose the best one and implement it today.",
          quiz: {
            question: "Which is more powerful?",
            options: [
              "AI alone",
              "Human alone",
              "Human + AI working together",
              "Neither"
            ],
            answerIndex: 2
          }
        }
      ]
    };

    var worldLanguages = {
      subjectLabel: "World Languages (10+)",
      level: "Any class",
      topics: [
        {
          id: "lang-5-phrases",
          title: "5 Magic Phrases (Any Language Pair)",
          level: "Easy",
          body:
"Concept:\nLearning any language becomes easier when you master a few daily phrases first.\n\nAI/LLM Connection:\n‚Ä¢ Ask Comet: ‚ÄúTranslate these 5 phrases between [my language] and [target language] with pronunciation.‚Äù\n‚Ä¢ Use AI to get example sentences and practice aloud.\n\nReal-World Application:\n‚Ä¢ Talk to people from other countries.\n‚Ä¢ Open remote work, freelancing, customer support, global teams.\n\nMini Project:\nChoose ‚ÄòI know‚Äô and ‚ÄòI want to learn‚Äô languages in the controls above. Practice saying all 5 phrases 10 times each using both languages.",
          quiz: {
            question: "What is a good first step in any language?",
            options: [
              "Memorise full dictionary",
              "Learn 5 daily phrases and use them",
              "Only read grammar rules",
              "Wait for school to teach everything"
            ],
            answerIndex: 1
          }
        },
        {
          id: "lang-listen-copy",
          title: "Listen + Copy: Sound First, Spelling Later",
          level: "Core",
          body:
"Concept:\nChildren learn language by listening and copying, not by reading grammar first.\n\nAI/LLM Connection:\n‚Ä¢ Use AI to get slow audio sentences (text-to-speech) and repeat after it.\n‚Ä¢ Ask Comet: ‚ÄúGive me 10 simple sentences in [target language] with meaning in [my language].‚Äù\n\nReal-World Application:\n‚Ä¢ You sound more natural when speaking.\n‚Ä¢ Helps in interviews, customer calls, remote jobs.\n\nMini Project:\nPick 3 phrases from the table below. Use device TTS or Comet AI to speak them. Record yourself and compare.",
          quiz: {
            question: "For fast language learning, what usually comes first?",
            options: [
              "Spelling and writing",
              "Listening and copying sounds",
              "Memorising exam answers",
              "Translating big essays"
            ],
            answerIndex: 1
          }
        }
      ]
    };

    // ---------- Future-Ready Skill Tracks per Class ----------
    var syllabus = {};

    function buildClassSyllabus(levelLabel) {
      return {
        MathSkills: {
          subjectLabel: "Math + Money & Data",
          level: levelLabel,
          topics: [
            {
              id: "math-money-basics",
              title: "Numbers + Money Sense",
              level: "Starter",
              body:
"Concept:\nMath is not only for exams; it is for money, shopping, saving and business.\n\nAI/LLM Connection:\n‚Ä¢ Ask Comet: ‚ÄúExplain profit, loss, discount in very simple steps with real examples.‚Äù\n‚Ä¢ Use AI to generate small word problems about pocket money.\n\nReal-World Application:\n‚Ä¢ You can check if someone overcharged you.\n‚Ä¢ You understand savings, interest and small business ideas.\n\nMini Project:\nTrack every rupee you spend today (snacks, travel, recharge). At night, ask Comet to help you make a simple daily budget from that list.",
              quiz: {
                question: "Why is math important in real life here?",
                options: [
                  "Only for passing exams",
                  "For checking money, prices and savings",
                  "Only for scientists",
                  "It has no real use"
                ],
                answerIndex: 1
              }
            }
          ]
        },

        ScienceThinking: {
          subjectLabel: "Science + Problem Solving",
          level: levelLabel,
          topics: [
            {
              id: "sci-curiosity-ai",
              title: "Curiosity, Experiments & AI",
              level: "Starter",
              body:
"Concept:\nScience starts with curiosity: ‚ÄúWhy?‚Äù ‚ÄúHow?‚Äù ‚ÄúWhat if?‚Äù. Experiments test ideas.\n\nAI/LLM Connection:\n‚Ä¢ Ask Comet: ‚ÄúGive me 3 simple experiments I can do at home with safety.‚Äù\n‚Ä¢ Use AI to predict and then test the result.\n\nReal-World Application:\n‚Ä¢ You become better at troubleshooting (devices, code, daily problems).\n‚Ä¢ Companies pay problem-solvers, not memorisers.\n\nMini Project:\nPick a daily problem (slow phone, messy bag, late homework). Ask Comet for 3 scientific-style solutions. Test one and write what changed.",
              quiz: {
                question: "Science mainly starts with:",
                options: [
                  "Memorising definitions",
                  "Curiosity and questions",
                  "Copying notes",
                  "Ignoring problems"
                ],
                answerIndex: 1
              }
            }
          ]
        },

        EnglishCommunication: {
          subjectLabel: "English + Communication & Content",
          level: levelLabel,
          topics: [
            {
              id: "eng-clear-ideas",
              title: "Clear Communication in Simple Words",
              level: "Starter",
              body:
"Concept:\nGood communication = simple, clear, honest words that others understand easily.\n\nAI/LLM Connection:\n‚Ä¢ Ask Comet: ‚ÄúRewrite my sentence in simple, friendly English.‚Äù\n‚Ä¢ Ask: ‚ÄúGive me 3 better subject lines for this message.‚Äù\n\nReal-World Application:\n‚Ä¢ Email to clients, messages to teachers, job applications, freelancing profiles.\n\nMini Project:\nWrite a message to a friend explaining your dream skill or job. Ask Comet to improve it for clarity and politeness, then compare versions.",
              quiz: {
                question: "Good communication is mainly about:",
                options: [
                  "Using very difficult words",
                  "Being confusing and long",
                  "Being simple, clear and honest",
                  "Copying others‚Äô style without thinking"
                ],
                answerIndex: 2
              }
            }
          ]
        },

        Hindi: {
          subjectLabel: "Hindi Language",
          level: levelLabel,
          topics: [
            {
              id: "hin-basic-express",
              title: "‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§Ö‡§≠‡§ø‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø (Clear Expression)",
              level: "Starter",
              body:
"‡§∏‡§Ç‡§ï‡§≤‡•ç‡§™‡§®‡§æ:\n‡§∏‡§æ‡§´‡§º ‡§î‡§∞ ‡§∏‡§∞‡§≤ ‡§≠‡§æ‡§∑‡§æ ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§®‡•á ‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§≤‡§ø‡§ñ‡§®‡§æ ‡§î‡§∞ ‡§¨‡•ã‡§≤‡§®‡§æ ‡§è‡§ï ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§ï‡•å‡§∂‡§≤ ‡§π‡•à‡•§\n\n‡§è‡§Ü‡§à ‡§∏‡§Ç‡§¨‡§Ç‡§ß:\n‚Ä¢ Comet ‡§∏‡•á ‡§ï‡§π‡•á‡§Ç: ‚Äú‡§Æ‡•á‡§∞‡•á ‡§µ‡§æ‡§ï‡•ç‡§Ø ‡§ï‡•ã ‡§∏‡§∞‡§≤ ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§∏‡•Å‡§ß‡§æ‡§∞‡•ã‡•§‚Äù\n‚Ä¢ ‡§è‡§Ü‡§à ‡§∏‡•á ‡§õ‡•ã‡§ü‡•á ‡§∏‡§Ç‡§¶‡•á‡§∂, ‡§Ü‡§µ‡•á‡§¶‡§®-‡§™‡§§‡•ç‡§∞ ‡§Ø‡§æ ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§µ‡§æ‡§ï‡§∞ ‡§ñ‡•Å‡§¶ ‡§≠‡•Ä ‡§≤‡§ø‡§ñ‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç‡•§\n\n‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó:\n‚Ä¢ ‡§Ü‡§µ‡•á‡§¶‡§®-‡§™‡§§‡•ç‡§∞, ‡§™‡§§‡•ç‡§∞, ‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§ê‡§™ ‡§∏‡§Ç‡§¶‡•á‡§∂, ‡§®‡•ã‡§ü‡§ø‡§∏ ‡§Ü‡§¶‡§ø ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶‡•§\n\n‡§Æ‡§ø‡§®‡•Ä ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü:\n‡§ï‡§ø‡§∏‡•Ä ‡§è‡§ï ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§™‡§∞ 4‚Äì5 ‡§µ‡§æ‡§ï‡•ç‡§Ø ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§≤‡§ø‡§ñ‡•á‡§Ç, ‡§´‡§ø‡§∞ Comet ‡§∏‡•á ‡§â‡§∏‡•á ‡§∏‡•Å‡§ß‡§æ‡§∞‡§®‡•á ‡§ï‡•ã ‡§ï‡§π‡•á‡§Ç ‡§î‡§∞ ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§§‡•Å‡§≤‡§®‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§",
              quiz: {
                question: "‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§Ö‡§≠‡§ø‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§Æ‡•á‡§Ç ‡§ï‡•ç‡§Ø‡§æ ‡§ú‡§º‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à?",
                options: [
                  "‡§¨‡§π‡•Å‡§§ ‡§ï‡§†‡§ø‡§® ‡§∂‡§¨‡•ç‡§¶",
                  "‡§≤‡§Ç‡§¨‡•á-‡§≤‡§Ç‡§¨‡•á ‡§µ‡§æ‡§ï‡•ç‡§Ø",
                  "‡§∏‡§æ‡§´‡§º ‡§î‡§∞ ‡§∏‡§∞‡§≤ ‡§≠‡§æ‡§∑‡§æ",
                  "‡§ï‡•á‡§µ‡§≤ ‡§Ö‡§Ç‡§ó‡•ç‡§∞‡•á‡§ú‡§º‡•Ä ‡§∂‡§¨‡•ç‡§¶"
                ],
                answerIndex: 2
              }
            }
          ]
        },

        SuperLearning: superLearning,
        Languages: worldLanguages,

        DigitalMarketing: {
          subjectLabel: "Digital Marketing & Social Media",
          level: levelLabel,
          topics: [
            {
              id: "dm-storytelling-basic",
              title: "Story Posts vs. Plain Posts",
              level: "Starter",
              body:
"Concept:\nOn social media, stories (before/after, problem/solution) work better than random posts.\n\nAI/LLM Connection:\n‚Ä¢ Ask Comet: ‚ÄúTurn this boring sentence into a short story for Instagram or YouTube community.‚Äù\n‚Ä¢ Ask: ‚ÄúGive 5 hook lines for a reel about [topic].‚Äù\n\nReal-World Application:\n‚Ä¢ You can promote school events, projects, small businesses.\n‚Ä¢ Later, you can earn by handling social media for clients.\n\nMini Project:\nPick one topic you love (cricket, drawing, coding, food). Ask Comet for 3 reel hook ideas. Write them down and choose your favourite.",
              quiz: {
                question: "What works better in social media content?",
                options: [
                  "Random plain statements",
                  "Copy-pasting others‚Äô posts",
                  "Story-based posts with hook and solution",
                  "Long textbook paragraphs"
                ],
                answerIndex: 2
              }
            }
          ]
        },

        CodingNoCode: {
          subjectLabel: "Coding & No-Code Apps",
          level: levelLabel,
          topics: [
            {
              id: "code-think-like-computer",
              title: "Think Like a Computer (Logic Blocks)",
              level: "Starter",
              body:
"Concept:\nCoding = giving step-by-step instructions a computer can follow.\n\nAI/LLM Connection:\n‚Ä¢ Ask Comet: ‚ÄúExplain if/else and loops with simple daily life examples.‚Äù\n‚Ä¢ Ask: ‚ÄúGenerate a simple pseudo-code to remind me to drink water every hour.‚Äù\n\nReal-World Application:\n‚Ä¢ You can build tools that save time (timers, calculators, trackers).\n‚Ä¢ Connect no-code tools with AI to make mini-automations.\n\nMini Project:\nDescribe a daily routine (wake up, school, study, play). Ask Comet to convert it to step-by-step pseudo-code. See how close coding is to your real day.",
              quiz: {
                question: "Coding mainly means:",
                options: [
                  "Memorising many languages",
                  "Giving step-by-step instructions to a computer",
                  "Only designing screens",
                  "Playing video games"
                ],
                answerIndex: 1
              }
            }
          ]
        },

        DesignVideo: {
          subjectLabel: "Graphic Design & Video Editing",
          level: levelLabel,
          topics: [
            {
              id: "design-simple-layout",
              title: "Simple Layout > Too Many Effects",
              level: "Starter",
              body:
"Concept:\nGood design is clear and focused: few colours, readable text, one main message.\n\nAI/LLM Connection:\n‚Ä¢ Ask Comet: ‚ÄúGive me a layout idea for a poster about [topic] with headings and subpoints.‚Äù\n‚Ä¢ Ask: ‚ÄúGive title ideas for a YouTube thumbnail that are short and powerful.‚Äù\n\nReal-World Application:\n‚Ä¢ Posters for school, NGO, fundraising, local business.\n‚Ä¢ Thumbnails and shorts that get more clicks.\n\nMini Project:\nChoose one cause (save water, help strays, fundraiser). Ask Comet to suggest a poster structure. Then design it using any free tool (Canva, etc.).",
              quiz: {
                question: "Which is usually better in design?",
                options: [
                  "Too many colours and fonts",
                  "Clear layout with one main message",
                  "Tiny text everywhere",
                  "Maximum animations"
                ],
                answerIndex: 1
              }
            }
          ]
        },

        BusinessEntrepreneurship: {
          subjectLabel: "Business & Entrepreneurship",
          level: levelLabel,
          topics: [
            {
              id: "biz-problem-solution",
              title: "Business = Solving Problems",
              level: "Starter",
              body:
"Concept:\nA business is simply: find a problem, solve it, get paid fairly for the solution.\n\nAI/LLM Connection:\n‚Ä¢ Ask Comet: ‚ÄúList 10 problems students/parents/teachers face daily. Turn them into simple business ideas.‚Äù\n‚Ä¢ Ask: ‚ÄúHelp me create a one-line pitch for this idea.‚Äù\n\nReal-World Application:\n‚Ä¢ You can start tiny services: notes summarising, poster design, local delivery coordination, etc.\n\nMini Project:\nWrite down 3 problems you or your friends face at school or home. Ask Comet to turn each into a small service idea and first paying customer type.",
              quiz: {
                question: "According to this lesson, business mainly starts from:",
                options: [
                  "Having lots of money",
                  "Solving real problems",
                  "Copying big companies",
                  "Creating an app first"
                ],
                answerIndex: 1
              }
            }
          ]
        },

        AITools: {
          subjectLabel: "AI Tools, LLMs & Automation",
          level: levelLabel,
          topics: [
            {
              id: "ai-basics-llm",
              title: "What is an LLM? (Class 1‚Äì5 version)",
              level: "Core",
              body:
"Concept:\nLLM = Large Language Model. It is a computer program that learned from many texts and predicts the next word.\n\nFor Small Classes:\n‚Ä¢ Think of it as a super-fast reader that suggests sentences, stories, answers.\n‚Ä¢ It doesn‚Äôt ‚Äúknow everything‚Äù, but can help think faster.\n\nReal-World Application:\n‚Ä¢ Homework help, idea generation, content creation, research.\n‚Ä¢ Later: code, marketing, customer support, automation.\n\nMini Project:\nAsk Comet: ‚ÄúExplain what you are in 3 lines to a 10-year-old.‚Äù Read and show it to a friend or parent.",
              quiz: {
                question: "An LLM mainly does what?",
                options: [
                  "Predicts the next word based on patterns",
                  "Controls robots directly",
                  "Prints money",
                  "Reads minds"
                ],
                answerIndex: 0
              }
            }
          ]
        },

        ContentWriting: {
          subjectLabel: "Content Writing & Copywriting",
          level: levelLabel,
          topics: [
            {
              id: "cw-hook-body-cta",
              title: "Hook + Body + CTA (Simple Copywriting)",
              level: "Starter",
              body:
"Concept:\nGood content often follows: Hook (grab attention) ‚Üí Body (explain) ‚Üí CTA (what next?).\n\nAI/LLM Connection:\n‚Ä¢ Ask Comet: ‚ÄúTurn this paragraph into Hook + Body + CTA for [Instagram / LinkedIn / Email].‚Äù\n‚Ä¢ Ask: ‚ÄúGive 3 different hooks for the same topic.‚Äù\n\nReal-World Application:\n‚Ä¢ Posts, emails, landing pages, sales pages, fundraiser messages.\n\nMini Project:\nChoose any topic (fundraiser, school event, your skill). Write a rough paragraph. Ask Comet to convert it to Hook + Body + CTA. Compare with your version.",
              quiz: {
                question: "In this lesson, CTA stands for:",
                options: [
                  "Call to Action",
                  "Code to Apply",
                  "Copy Text Area",
                  "Class Test Answer"
                ],
                answerIndex: 0
              }
            }
          ]
        },

        FreelancingIncome: {
          subjectLabel: "Freelancing & Online Income",
          level: levelLabel,
          topics: [
            {
              id: "free-skill-portfolio",
              title: "Skills + Portfolio > Certificates",
              level: "Starter",
              body:
"Concept:\nClients mostly care about what you can DO and SHOW, not just certificates.\n\nAI/LLM Connection:\n‚Ä¢ Ask Comet: ‚ÄúList 5 simple online services I can offer as a student using AI (content, research, design, etc.).‚Äù\n‚Ä¢ Ask: ‚ÄúHelp me write a mini profile for my first freelancing gig.‚Äù\n\nReal-World Application:\n‚Ä¢ Fiverr, Upwork, direct clients, local businesses.\n\nMini Project:\nPick one skill track you like (design, content, coding). With Comet‚Äôs help, write a 3-line profile and 3 sample service descriptions for a future gig.",
              quiz: {
                question: "For freelancing, what is usually more important?",
                options: [
                  "Only certificates",
                  "Real skills and portfolio",
                  "Fancy job title",
                  "Having many apps installed"
                ],
                answerIndex: 1
              }
            }
          ]
        },

        ProjectSkills: {
          subjectLabel: "Projects, Management & Public Speaking",
          level: levelLabel,
          topics: [
            {
              id: "proj-small-start",
              title: "Micro Projects: Start Tiny, Learn Fast",
              level: "Starter",
              body:
"Concept:\nInstead of dreaming of a huge startup, start with tiny ‚Äúmicro projects‚Äù that finish in 1‚Äì7 days.\n\nAI/LLM Connection:\n‚Ä¢ Ask Comet: ‚ÄúSuggest 5 micro projects for my age in [topic: design / AI / coding / marketing].‚Äù\n‚Ä¢ Ask: ‚ÄúCreate a 2-minute speech to present my project to my class.‚Äù\n\nReal-World Application:\n‚Ä¢ Builds your portfolio and confidence.\n‚Ä¢ Ready for hackathons, internships, real jobs later.\n\nMini Project:\nAsk Comet for 3 micro project ideas related to your favourite skill track. Choose one and plan 3 simple steps to finish it this week.",
              quiz: {
                question: "Micro projects are:",
                options: [
                  "Huge startups only",
                  "Small, quickly finished projects to learn fast",
                  "Only for toppers",
                  "Only for adults"
                ],
                answerIndex: 1
              }
            }
          ]
        }
      };
    }

    // Build syllabus for all classes
    for (var c = 1; c <= 12; c++) {
      var levelLabel =
        c <= 5 ? "Foundations (Classes 1‚Äì5)" :
        c <= 8 ? "Builders (Classes 6‚Äì8)" :
        "Launchpad (Classes 9‚Äì12)";
      syllabus[String(c)] = buildClassSyllabus(levelLabel);
    }

    // ---------- Progress Storage ----------
    var STORAGE_KEY = "fs_progress_v1";
    var progress = JSON.parse(localStorage.getItem(STORAGE_KEY) || "null");
    if (!progress) {
      progress = {
        lessons: {},
        quizAttempts: 0,
        quizCorrect: 0
      };
    }

    function saveProgress() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(progress));
      updateGlobalProgressUI();
    }

    // ---------- DOM References ----------
    var classGrid;
    var subjectsRow;
    var topicList;
    var lessonTitle;
    var lessonBody;
    var qaSection;
    var quizQuestionEl;
    var optionsContainer;
    var nextQuestionBtn;
    var speakLessonBtn;
    var speakQuestionBtn;

    var overallProgressFill;
    var overallProgressLabel;
    var overallScoreLabel;
    var progressPillText;
    var offlineLabel;
    var onlineChip;
    var storageNote;

    var languageSelect;
    var appTitle;
    var appSubtitle;
    var classHeading;
    var classSubtitle;
    var subjectHeading;
    var subjectSubtitle;
    var topicHeading;
    var topicSubtitle;
    var metaClass;
    var metaSubject;
    var metaTopicCount;

    var knownLangSelect;
    var targetLangSelect;
    var langPairControls;

    // AI elements
    var aiBackdrop;
    var openAiBtn;
    var closeAiBtn;
    var aiChat;
    var aiTextInput;
    var aiSendBtn;
    var aiFileInput;
    var aiUrlInput;
    var aiUrlAnalyzeBtn;
    var aiStatusDot;
    var aiOnlineStatusText;
    var aiStatusLine;

    // Wisdom DOM elements
var wisdomToggle = document.getElementById("wisdomToggle");
var wisdomPanel = document.getElementById("wisdomPanel");
var wisdomCloseBtn = document.getElementById("wisdomCloseBtn");
var wisdomLangSelect = document.getElementById("wisdomLangSelect");

var wisdomList = document.getElementById("wisdomList");
var wisdomStoryTitle = document.getElementById("wisdomStoryTitle");
var wisdomStoryMeta = document.getElementById("wisdomStoryMeta");
var wisdomStoryText = document.getElementById("wisdomStoryText");
var wisdomReflectionText = document.getElementById("wisdomReflectionText");
var wisdomChallengeText = document.getElementById("wisdomChallengeText");
var wisdomAudioBtn = document.getElementById("wisdomAudioBtn");
var wisdomThemePill = document.getElementById("wisdomThemePill");
var wisdomStoryLabelEl = document.getElementById("wisdomStoryLabel");
var wisdomReflectionLabelEl = document.getElementById("wisdomReflectionLabel");
var wisdomChallengeLabelEl = document.getElementById("wisdomChallengeLabel");
var wisdomTitleMainEl = document.getElementById("wisdomTitleMain");
var wisdomTitleSubEl = document.getElementById("wisdomTitleSub");

var currentWisdomId = null;

    function renderWisdomUIStrings() {
  var t = wisdomUIText[wisdomUILang] || wisdomUIText.en;
  if (wisdomTitleMainEl) wisdomTitleMainEl.textContent = t.panelTitle;
  if (wisdomTitleSubEl) wisdomTitleSubEl.textContent = t.panelSub;
  if (wisdomStoryLabelEl) wisdomStoryLabelEl.textContent = t.storyLabel;
  if (wisdomReflectionLabelEl) wisdomReflectionLabelEl.textContent = t.reflectionLabel;
  if (wisdomChallengeLabelEl) wisdomChallengeLabelEl.textContent = t.challengeLabel;
  if (wisdomReflectionText && (!currentWisdomId)) {
    wisdomReflectionText.textContent = t.defaultReflection;
  }
  if (wisdomChallengeText && (!currentWisdomId)) {
    wisdomChallengeText.textContent = t.defaultChallenge;
  }
  if (wisdomThemePill) wisdomThemePill.textContent = t.themeDefault;
}

function renderWisdomList() {
  if (!wisdomList) return;
  wisdomList.innerHTML = "";

  wisdomStories.forEach(function (item) {
    var div = document.createElement("div");
    div.className = "wisdom-item";
    div.dataset.id = item.id;

    div.innerHTML =
      '<div class="wisdom-item-title">' + item.title + '</div>' +
      '<div class="wisdom-item-meta">' +
        item.name + " ‚Ä¢ " + item.theme +
      "</div>";

    div.addEventListener("click", function () {
      currentWisdomId = item.id;
      var all = wisdomList.querySelectorAll(".wisdom-item");
      for (var i = 0; i < all.length; i++) all[i].classList.remove("active");
      div.classList.add("active");
      loadWisdomStory(item);
    });

    wisdomList.appendChild(div);
  });
}

function loadWisdomStory(item) {
  var t = wisdomUIText[wisdomUILang] || wisdomUIText.en;
  if (wisdomStoryTitle) wisdomStoryTitle.textContent = item.title;
  if (wisdomStoryMeta) {
    wisdomStoryMeta.textContent =
      item.sourceType + " ‚Ä¢ " + item.name + " ‚Ä¢ Age " + item.ageRange;
  }
  if (wisdomStoryText) {
    wisdomStoryText.textContent =
      item.context + "\n\n" + item.story + "\n\nTeaching (summary): " + item.teaching;
  }
  if (wisdomReflectionText) {
    wisdomReflectionText.textContent = item.reflection || t.defaultReflection;
  }
  if (wisdomChallengeText) {
    wisdomChallengeText.textContent = item.challenge || t.defaultChallenge;
  }
  if (wisdomThemePill) {
    wisdomThemePill.textContent = item.theme || t.themeDefault;
  }
}

function speakWisdomStory() {
  if (!currentWisdomId) {
    // no specific story selected: read panel intro
    var intro =
      (wisdomStoryTitle ? wisdomStoryTitle.textContent + ". " : "") +
      (wisdomStoryText ? wisdomStoryText.textContent : "");
    speak(intro, wisdomUILang);
    return;
  }
  var item = null;
  for (var i = 0; i < wisdomStories.length; i++) {
    if (wisdomStories[i].id === currentWisdomId) {
      item = wisdomStories[i];
      break;
    }
  }
  if (!item) return;
  var text =
    item.title + ". " +
    item.context + ". " +
    item.story + ". Reflection: " +
    item.reflection + ". Action: " +
    item.challenge;
  speak(text, wisdomUILang);
}



    var currentClass = null;
    var currentSubject = null;
    var currentTopicIndex = 0;

    // ---------- UI Language Handling ----------
    function renderLanguage() {
      var t = uiText[currentLang];
      appTitle.textContent = t.title;
      appSubtitle.textContent = t.subtitle;
      classHeading.textContent = t.classHeading;
      classSubtitle.textContent = t.classSubtitle;
      subjectHeading.textContent = t.subjectHeading;
      subjectSubtitle.textContent = t.subjectSubtitle;
      topicHeading.textContent = t.topicHeading;
      topicSubtitle.textContent = t.topicSubtitle;
      offlineLabel.textContent = t.offlineReady;
      storageNote.textContent = t.storageNote;

      if (!currentClass || !currentSubject) {
        lessonTitle.textContent = t.startTitle;
        lessonBody.textContent = t.startBody;
      }

      updateGlobalProgressUI();
    }

    // ---------- Helpers ----------
    function getClassData(classId) {
      return syllabus[classId] || null;
    }

    function getSubjectData(classId, subjectKey) {
      var cls = getClassData(classId);
      if (!cls) return null;
      var subj = cls[subjectKey];
      return subj || null;
    }

    function getTopicKey(classId, subjectKey, topicId) {
      return classId + "-" + subjectKey + "-" + topicId;
    }

    // ---------- Class & Subject ----------
    function initClassGrid() {
      classGrid.innerHTML = "";
      for (var c = 1; c <= 12; c++) {
        (function (cVal) {
          var btn = document.createElement("button");
          btn.className = "pill-btn";
          btn.textContent = "Class " + cVal;
          btn.dataset.classValue = String(cVal);
          btn.addEventListener("click", function () {
            var all = document.querySelectorAll("#classGrid .pill-btn");
            for (var i = 0; i < all.length; i++) {
              all[i].classList.remove("active");
            }
            btn.classList.add("active");
            currentClass = String(cVal);
            currentSubject = null;
            renderSubjects();
            renderTopics();
            metaClass.textContent = "Class " + currentClass;
            metaSubject.textContent = "Track \u2013";
          });
          classGrid.appendChild(btn);
        })(c);
      }
    }

    function renderSubjects() {
      subjectsRow.innerHTML = "";
      var data = getClassData(currentClass);
      if (!data) {
        subjectsRow.innerHTML =
          '<span style="font-size:12px;opacity:0.7;">Syllabus for this class will be added soon.</span>';
        metaTopicCount.textContent = "0 topics";
        langPairControls.style.display = "none";
        return;
      }

      for (var subjectKey in data) {
        if (!data.hasOwnProperty(subjectKey)) continue;
        var subject = data[subjectKey];
        var card = document.createElement("div");
        card.className = "subject-card";
        if (currentSubject === subjectKey) card.classList.add("active");

        var icon =
          subjectKey === "MathSkills" ? "üßÆ" :
          subjectKey === "ScienceThinking" ? "üî¨" :
          subjectKey === "EnglishCommunication" ? "üó£Ô∏è" :
          subjectKey === "Hindi" ? "üìù" :
          subjectKey === "SuperLearning" ? "‚ö°" :
          subjectKey === "Languages" ? "üåç" :
          subjectKey === "DigitalMarketing" ? "üìä" :
          subjectKey === "CodingNoCode" ? "üíª" :
          subjectKey === "DesignVideo" ? "üé®" :
          subjectKey === "BusinessEntrepreneurship" ? "üíº" :
          subjectKey === "AITools" ? "ü§ñ" :
          subjectKey === "ContentWriting" ? "üìù" :
          subjectKey === "FreelancingIncome" ? "üí∞" :
          subjectKey === "ProjectSkills" ? "üéØ" :
          "üìò";

        card.innerHTML =
          '<div class="subject-pill">' + icon + " " + subject.subjectLabel + '</div>' +
          '<div class="subject-main">' + subject.subjectLabel + '</div>' +
          '<div class="subject-sub">' + subject.level + '</div>' +
          '<div class="tag-row">' +
            '<span class="tiny-tag">' + subject.topics.length + ' topics</span>' +
            '<span class="tiny-tag">Skills + AI</span>' +
          '</div>';

        (function (subjectKey) {
          card.addEventListener("click", function () {
            var allCards = document.querySelectorAll(".subject-card");
            for (var i = 0; i < allCards.length; i++) {
              allCards[i].classList.remove("active");
            }
            card.classList.add("active");
            currentSubject = subjectKey;
            renderTopics();
            metaSubject.textContent = subject.subjectLabel;
          });
        })(subjectKey);

        subjectsRow.appendChild(card);
      }
    }

    function renderTopics() {
      var t = uiText[currentLang];
      topicList.innerHTML = "";

      if (!currentClass || !currentSubject) {
        metaTopicCount.textContent = "0 topics";
        lessonTitle.textContent = t.startTitle;
        lessonBody.textContent = t.startBody;
        qaSection.style.display = "none";
        langPairControls.style.display = "none";
        return;
      }

      var subjectData = getSubjectData(currentClass, currentSubject);
      if (!subjectData) {
        metaTopicCount.textContent = "0 topics";
        topicList.innerHTML =
          '<span style="font-size:12px;opacity:0.7;">Topics for this track will be added soon.</span>';
        langPairControls.style.display = "none";
        return;
      }

      metaTopicCount.textContent = subjectData.topics.length + " topics";

      subjectData.topics.forEach(function (topic, index) {
        var row = document.createElement("div");
        row.className = "topic-item";
        row.dataset.index = index;
        row.innerHTML =
          "<span>" + topic.title + "</span>" +
          '<span style="font-size:11px;opacity:0.7;">' + topic.level + "</span>";
        row.addEventListener("click", function () {
          var all = document.querySelectorAll(".topic-item");
          for (var i = 0; i < all.length; i++) {
            all[i].classList.remove("active");
          }
          row.classList.add("active");
          currentTopicIndex = index;
          loadLessonAndQuiz();
        });
        topicList.appendChild(row);
      });

      if (currentSubject === "Languages") {
        langPairControls.style.display = "flex";
      } else {
        langPairControls.style.display = "none";
      }
    }

    function loadLessonAndQuiz() {
      if (!currentClass || !currentSubject) return;
      var subjectData = getSubjectData(currentClass, currentSubject);
      if (!subjectData) return;

      var topic = subjectData.topics[currentTopicIndex];
      if (!topic) return;

      if (currentSubject === "Languages") {
        renderLanguagePhraseView(topic);
      } else {
        lessonTitle.textContent = topic.title;
        lessonBody.textContent = topic.body;
      }

      qaSection.style.display = "block";
      renderQuiz(topic);
      markLessonCompleted(topic);
    }

    function markLessonCompleted(topic) {
      var key = getTopicKey(currentClass, currentSubject, topic.id);
      if (!progress.lessons[key]) {
        progress.lessons[key] = { completed: true, bestScore: 0 };
      } else if (!progress.lessons[key].completed) {
        progress.lessons[key].completed = true;
      }
      saveProgress();
    }

    // ---------- Language Pair Controls ----------
    function initLanguagePairSelectors() {
      knownLangSelect.innerHTML = "";
      targetLangSelect.innerHTML = "";

      supportedLanguages.forEach(function (lang) {
        var opt1 = document.createElement("option");
        opt1.value = lang.code;
        opt1.textContent = lang.native + " (" + lang.name + ")";
        knownLangSelect.appendChild(opt1);

        var opt2 = document.createElement("option");
        opt2.value = lang.code;
        opt2.textContent = lang.native + " (" + lang.name + ")";
        targetLangSelect.appendChild(opt2);
      });

      var savedKnown = localStorage.getItem("fs_knownLang") || "en";
      var savedTarget = localStorage.getItem("fs_targetLang") || "hi";

      var hasKnown = supportedLanguages.some(function (l) { return l.code === savedKnown; });
      var hasTarget = supportedLanguages.some(function (l) { return l.code === savedTarget; });

      if (hasKnown) knownLangSelect.value = savedKnown;
      if (hasTarget) targetLangSelect.value = savedTarget;

      knownLangSelect.addEventListener("change", function () {
        localStorage.setItem("fs_knownLang", knownLangSelect.value);
        if (currentSubject === "Languages") renderLanguagePhraseView();
      });

      targetLangSelect.addEventListener("change", function () {
        localStorage.setItem("fs_targetLang", targetLangSelect.value);
        if (currentSubject === "Languages") renderLanguagePhraseView();
      });
    }

    function renderLanguagePhraseView(topicParam) {
      if (currentSubject !== "Languages") return;

      var subjectData = getSubjectData(currentClass, currentSubject);
      if (!subjectData) return;

      var topic = topicParam || subjectData.topics[currentTopicIndex];
      if (!topic) return;

      var knownCode = knownLangSelect.value;
      var targetCode = targetLangSelect.value;

      lessonTitle.textContent = topic.title;

      var explanationHtml = topic.body.replace(/\n/g, "<br>");

      var tableHtml =
        '<div style="margin-top:6px; font-size:12px;">' +
          '<div style="display:flex; font-weight:600; margin-bottom:4px;">' +
            '<div style="flex:1;">Concept</div>' +
            '<div style="flex:1;">Known (' + knownCode + ')</div>' +
            '<div style="flex:1;">Target (' + targetCode + ')</div>' +
          '</div>';

      languagePhrases.forEach(function (p) {
        var knownPhrase = p.translations[knownCode] || "‚Äî";
        var targetPhrase = p.translations[targetCode] || "‚Äî";
        tableHtml +=
          '<div style="display:flex; margin-bottom:3px;">' +
            '<div style="flex:1;">' + p.concept + '</div>' +
            '<div style="flex:1;">' + knownPhrase + '</div>' +
            '<div style="flex:1;">' + targetPhrase + '</div>' +
          '</div>';
      });

      tableHtml += "</div>";

      lessonBody.innerHTML = explanationHtml + tableHtml;
    }

    // ---------- Quiz ----------
    function renderQuiz(topic) {
      var quiz = topic.quiz;
      quizQuestionEl.textContent = quiz.question;
      optionsContainer.innerHTML = "";

      quiz.options.forEach(function (opt, index) {
        var btn = document.createElement("button");
        btn.className = "option-btn";
        btn.textContent = String.fromCharCode(65 + index) + ". " + opt;
        btn.dataset.index = index;
        btn.addEventListener("click", function () {
          handleAnswerClick(btn, index, quiz.answerIndex, topic);
        });
        optionsContainer.appendChild(btn);
      });
    }

    function handleAnswerClick(btn, chosenIndex, correctIndex, topic) {
      var optionButtons = optionsContainer.querySelectorAll(".option-btn");
      for (var i = 0; i < optionButtons.length; i++) {
        optionButtons[i].disabled = true;
      }

      progress.quizAttempts++;

      if (chosenIndex === correctIndex) {
        btn.classList.add("correct");
        progress.quizCorrect++;
      } else {
        btn.classList.add("wrong");
        if (optionButtons[correctIndex]) {
          optionButtons[correctIndex].classList.add("correct");
        }
      }

      var key = getTopicKey(currentClass, currentSubject, topic.id);
      var lessonEntry = progress.lessons[key];
      var currentBest = 0;
      if (lessonEntry && typeof lessonEntry.bestScore === "number") {
        currentBest = lessonEntry.bestScore;
      }
      var newScore = chosenIndex === correctIndex ? 100 : 0;
      if (!lessonEntry) {
        progress.lessons[key] = { completed: true, bestScore: newScore };
      } else if (newScore > currentBest) {
        progress.lessons[key].bestScore = newScore;
      }

      saveProgress();
    }

    // ---------- Text-to-Speech ----------
    function speak(text, langOverride) {
      if (!("speechSynthesis" in window)) {
        alert("Text-to-speech not supported on this device.");
        return;
      }
      var msg = new SpeechSynthesisUtterance(text);
      var langCode = langOverride || currentLang;
      msg.lang =
        langCode === "hi" ? "hi-IN" :
        langCode === "te" ? "te-IN" :
        langCode === "es" ? "es-ES" :
        langCode === "zh" ? "zh-CN" :
        langCode === "ar" ? "ar-SA" :
        langCode === "fr" ? "fr-FR" :
        langCode === "pt" ? "pt-BR" :
        langCode === "ru" ? "ru-RU" :
        langCode === "ja" ? "ja-JP" :
        langCode === "de" ? "de-DE" :
        "en-IN";
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(msg);
    }

    // ---------- Progress UI ----------
    function calculateTotalLessons() {
      var count = 0;
      for (var classId in syllabus) {
        if (!syllabus.hasOwnProperty(classId)) continue;
        var classObj = syllabus[classId];
        for (var subjectKey in classObj) {
          if (!classObj.hasOwnProperty(subjectKey)) continue;
          count += classObj[subjectKey].topics.length;
        }
      }
      return count;
    }

    function updateGlobalProgressUI() {
      var t = uiText[currentLang];

      var lessonKeys = Object.keys(progress.lessons || {});
      var completedLessons = lessonKeys.filter(function (k) {
        return progress.lessons[k].completed;
      }).length;

      var totalLessons = calculateTotalLessons();
      var completionPercent = totalLessons === 0
        ? 0
        : Math.round((completedLessons / totalLessons) * 100);

      var avgScore =
        progress.quizAttempts === 0
          ? 0
          : Math.round((progress.quizCorrect / progress.quizAttempts) * 100);

      overallProgressFill.style.width = completionPercent + "%";
      overallProgressLabel.textContent =
        completedLessons === 0
          ? t.noLessons
          : completedLessons + "/" + totalLessons + " lessons completed";
      overallScoreLabel.textContent = t.avgScore(avgScore);
      progressPillText.textContent =
        t.progressPill(completedLessons, progress.quizAttempts, avgScore);
    }

    // ---------- Connectivity ----------
    function updateOnlineStatus() {
      var isOnline = navigator.onLine;
      onlineChip.style.display = isOnline ? "inline-flex" : "none";

      if (isOnline) {
        aiStatusDot.style.background = "#22c55e";
        aiOnlineStatusText.textContent = "Online AI";
        aiStatusLine.textContent = "Using online AI model + offline syllabus";
      } else {
        aiStatusDot.style.background = "#f97316";
        aiOnlineStatusText.textContent = "Offline mode";
        aiStatusLine.textContent = "Using offline knowledge base only";
      }
    }

    // ---------- Service Worker ----------
    function registerServiceWorker() {
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("service-worker.js")
          .then(function () { console.log("Service worker registered."); })
          .catch(function (err) { console.error("Service worker registration failed:", err); });
      }
    }

    // ---------- AI Assistant (Hybrid) ----------
    var OPENROUTER_API_KEY = ""; // Put your key here when ready.

    function addAiMessage(role, text) {
      var row = document.createElement("div");
      row.className = "ai-message-row " + (role === "user" ? "user" : "assistant");

      var bubble = document.createElement("div");
      bubble.className = "ai-message-bubble";
      bubble.textContent = text;
      row.appendChild(bubble);

      aiChat.appendChild(row);
      aiChat.scrollTop = aiChat.scrollHeight;
    }

    function addAiSystemNote(text) {
      addAiMessage("assistant", text);
    }

    function getLocalContextSnippet() {
      var snippet = "";
      if (lessonTitle && lessonTitle.textContent && lessonTitle.textContent.trim().length > 0) {
        snippet += "Current lesson title: " + lessonTitle.textContent + ". ";
      }
      if (lessonBody && lessonBody.textContent && lessonBody.textContent.trim().length > 0) {
        snippet += "Lesson content: " + lessonBody.textContent.slice(0, 600);
      }
      return snippet;
    }

    function offlineAnswer(prompt) {
      var lower = prompt.toLowerCase();
      if (/freelanc|income|online money|earn/.test(lower)) {
        return "Offline mode: Start small. Pick one skill (writing, design, research). Use AI to help you produce better work, then show 2‚Äì3 samples as your mini portfolio.";
      }
      if (/ai|llm|chatgpt|comet/.test(lower)) {
        return "Offline mode: An LLM like Comet or ChatGPT is a language model that predicts the next word. Your power comes from asking smart questions and checking answers carefully.";
      }
      if (/project|startup|business/.test(lower)) {
        return "Offline mode: Start with micro projects that solve a real problem around you. Keep them 1‚Äì7 days long, learn, then grow.";
      }
      return "Offline mode: Ask me about skills, AI, projects, business, language learning or any topic visible in this app. I‚Äôll answer using the built-in syllabus and simple reasoning.";
    }

    function callOpenRouter(prompt, extraContext, callback) {
      if (!OPENROUTER_API_KEY) {
        callback("Online AI is not configured yet. Add your OpenRouter API key in index.html (OPENROUTER_API_KEY) to enable full AI answers.");
        return;
      }

      var messages = [
        {
          role: "system",
          content:
"You are Comet, a kind, concise AI tutor for students (Class 1‚Äì12) learning future-ready skills, AI, freelancing and business. Explain step-by-step in simple language."
        },
        {
          role: "user",
          content: (extraContext ? ("Context:\n" + extraContext + "\n\n") : "") +
            "Question:\n" + prompt
        }
      ];

      fetch("https://openrouter.ai/api/v1/chat/completions", {
        method: "POST",
        headers: {
          "Authorization": "Bearer " + OPENROUTER_API_KEY,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          model: "meta-llama/llama-3-8b-instruct:free",
          messages: messages,
          max_tokens: 512,
          temperature: 0.6
        })
      })
      .then(function (res) {
        if (!res.ok) {
          callback("Error from online AI (" + res.status + "). I‚Äôll fall back to offline thinking. Check your OpenRouter key and network.");
          return null;
        }
        return res.json();
      })
      .then(function (data) {
        if (!data) return;
        var text = data.choices && data.choices[0] && data.choices[0].message && data.choices[0].message.content ? data.choices[0].message.content : "";
        callback(text.trim() || "Online AI returned an empty answer. Please try again.");
      })
      .catch(function (e) {
        console.error("OpenRouter error", e);
        callback("Online AI call failed (network or CORS). I‚Äôll answer using offline knowledge instead.");
      });
    }

    function answerWithHybridAI(prompt, extraContext) {
      addAiMessage("user", prompt);
      addAiSystemNote(navigator.onLine
        ? "Thinking with online AI + skills syllabus..."
        : "Thinking with offline skills syllabus...");

      var ctx = extraContext || getLocalContextSnippet();
      if (!navigator.onLine) {
        var answer = offlineAnswer(prompt + " " + ctx);
        addAiMessage("assistant", answer);
        return;
      }

      callOpenRouter(prompt, ctx, function (answer) {
        addAiMessage("assistant", answer);
      });
    }

    function analyzeUrl(url) {
      if (!navigator.onLine) {
        addAiSystemNote("You are offline. I cannot fetch URLs, but you can paste text from the page and I‚Äôll help you.");
        return;
      }
      if (!url) {
        addAiSystemNote("Please paste a URL first.");
        return;
      }
      addAiSystemNote("Trying to fetch and analyze URL‚Ä¶");

      fetch(url)
        .then(function (res) { return res.text(); })
        .then(function (text) {
          var snippet = text.replace(/<[^>]*>/g, " ").replace(/\s+/g, " ").slice(0, 3000);
          answerWithHybridAI(
            "Summarize this webpage or video transcript in simple bullet points for a student. Focus on skills, AI, money or practical use.",
            snippet
          );
        })
        .catch(function (e) {
          console.error("URL fetch error", e);
          addAiSystemNote("I couldn't fetch that URL directly (CORS or network issue). Please copy-paste important text from the page, and I‚Äôll summarize it.");
        });
    }

    function handleFiles() {
      var files = Array.from(aiFileInput.files || []);
      if (!files.length) return;

      addAiSys

              // Wisdom sidebar events
if (wisdomLangSelect) {
  wisdomLangSelect.value = wisdomUILang;
  wisdomLangSelect.addEventListener("change", function () {
    wisdomUILang = wisdomLangSelect.value;
    localStorage.setItem("fs_wisdomLang", wisdomUILang);
    renderWisdomUIStrings();
  });
}
if (wisdomToggle && wisdomPanel) {
  wisdomToggle.addEventListener("click", function () {
    wisdomPanel.classList.add("open");
  });
}
if (wisdomCloseBtn && wisdomPanel) {
  wisdomCloseBtn.addEventListener("click", function () {
    wisdomPanel.classList.remove("open");
  });
}
if (wisdomAudioBtn) {
  wisdomAudioBtn.addEventListener("click", speakWisdomStory);
}

// Initial render for wisdom
renderWisdomUIStrings();
renderWisdomList();

